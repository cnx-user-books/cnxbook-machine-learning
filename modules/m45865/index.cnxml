<document xmlns="http://cnx.rice.edu/cnxml" xmlns:m="http://www.w3.org/1998/Math/MathML">
  <title>Machine Learning Lecture 1 Course Notes</title>
<metadata xmlns:md="http://cnx.rice.edu/mdml">
  <md:content-id>m45865</md:content-id>
  <md:title>Machine Learning Lecture 1 Course Notes</md:title>
  <md:abstract/>
  <md:uuid>c4f2bfc8-fc30-4401-b3aa-9ba9e73124a1</md:uuid>
</metadata>

<content>
    <section id="id140524">
      <title>Supervised learning</title>
      <para id="id140530">Let's start by talking about a few examples of supervised learning problems.
Suppose we have a dataset giving the living areas and prices of 47 houses from
Portland, Oregon:</para>
      <table id="id140535" summary="">
        <tgroup cols="2">
          <tbody>
            <row>
              <entry>Living area (feet<m:math overflow="scroll"><m:msup><m:mrow/><m:mn>2</m:mn></m:msup></m:math>)</entry>
              <entry>Price (1000$s)</entry>
            </row>
            <row>
              <entry>2104</entry>
              <entry>400</entry>
            </row>
            <row>
              <entry>1600</entry>
              <entry>330</entry>
            </row>
            <row>
              <entry>2400</entry>
              <entry>369</entry>
            </row>
            <row>
              <entry>1416</entry>
              <entry>232</entry>
            </row>
            <row>
              <entry>3000</entry>
              <entry>540</entry>
            </row>
            <row>
              <entry>
                <m:math overflow="scroll">
                  <m:mo>⋮</m:mo>
                </m:math>
              </entry>
              <entry>
                <m:math overflow="scroll">
                  <m:mo>⋮</m:mo>
                </m:math>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <!--empty paragraphs get left behind.-->
      <para id="id140647">We can plot this data:</para>
      <figure id="uid1"><media id="uid1_media" alt="scale of housing prices. square footage vs price.">
          <image mime-type="image/png" src="../../media/housingData.png" id="uid1_onlineimage" width="505"><!-- NOTE: attribute width changes image size online (pixels). original width is 505. --></image>
          <image mime-type="application/postscript" for="pdf" print-width="3.5in" src="../../media/housingData.eps" id="uid1_printimage"/>
        </media>
      </figure><para id="id140658">Given data like this, how can we learn to predict the prices of other houses in Portland, as a function
of the size of their living areas?</para>
      <para id="id140663">To establish notation for future use, we'll use <m:math overflow="scroll"><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> to denote the “input” variables (living area in this example), also called
input <emphasis effect="bold">features</emphasis>, and <m:math overflow="scroll"><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> to denote the “output” or <emphasis effect="bold">target</emphasis>
variable that we are trying to predict (price). A pair <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>,</m:mo><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:math> is called
a <emphasis effect="bold">training example</emphasis>, and the dataset that we'll be using to learn—a list of <m:math overflow="scroll"><m:mi>m</m:mi></m:math> training
examples <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>,</m:mo><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow><m:mo>;</m:mo><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>m</m:mi><m:mo>}</m:mo></m:mrow></m:math>—is called a <emphasis effect="bold">training set</emphasis>. Note that the superscript
“<m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:math>” in the notation is simply an index into the training set, and has nothing
to do with exponentiation. We will also use <m:math overflow="scroll"><m:mi mathvariant="script">X</m:mi></m:math> denote the space of input
values, and <m:math overflow="scroll"><m:mi mathvariant="script">Y</m:mi></m:math> the space of output values. In this example,
<m:math overflow="scroll"><m:mrow><m:mi mathvariant="script">X</m:mi><m:mo>=</m:mo><m:mi mathvariant="script">Y</m:mi><m:mo>=</m:mo><m:mi mathvariant="double-struck">R</m:mi></m:mrow></m:math>.</para><para id="id141076">To describe the supervised learning problem slightly more formally,
our goal is, given a training set, to learn a function
<m:math overflow="scroll"><m:mrow><m:mi>h</m:mi><m:mo>:</m:mo><m:mi mathvariant="script">X</m:mi><m:mo>↦</m:mo><m:mi mathvariant="script">Y</m:mi></m:mrow></m:math> so that <m:math overflow="scroll"><m:mrow><m:mi>h</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:math> is a “good” predictor
for the corresponding value of <m:math overflow="scroll"><m:mi>y</m:mi></m:math>. For historical reasons, this
function <m:math overflow="scroll"><m:mi>h</m:mi></m:math> is called a <emphasis effect="bold">hypothesis</emphasis>. Seen pictorially, the
process is therefore
like this:</para>
      <figure id="uid2"><media id="uid2_media" alt="training set leads to learning algorithm leads to hypothesis. x according to the hypothesis predicts y">
          <image mime-type="image/png" src="../../media/learningProcess.png" id="uid2_onlineimage" width="303"><!-- NOTE: attribute width changes image size online (pixels). original width is 303. --></image>
          <image mime-type="application/postscript" for="pdf" print-width="2in" src="../../media/learningProcess.eps" id="uid2_printimage"/>
        </media>
      </figure><para id="id141148">When the target variable that we're trying to predict is continuous, such as in our housing
example, we call the learning problem a <emphasis effect="bold">regression</emphasis> problem. When <m:math overflow="scroll"><m:mi>y</m:mi></m:math> can take
on only a small number of discrete values (such as if, given the living area,
we wanted to predict if a dwelling is a house or an apartment, say), we call
it a <emphasis effect="bold">classification</emphasis> problem.</para>
    </section>
    <section id="cid1">
      <title>Linear Regression</title>
      <para id="id141183">To make our housing example more interesting, let's consider a slightly richer
dataset in which we also know the number of bedrooms in each house:</para>
      <table id="id141187" summary="">
        <tgroup cols="3">
          <tbody>
            <row>
              <entry>Living area (feet<m:math overflow="scroll"><m:msup><m:mrow/><m:mn>2</m:mn></m:msup></m:math>)</entry>
              <entry>#bedrooms</entry>
              <entry>Price (1000$s)</entry>
            </row>
            <row>
              <entry>2104</entry>
              <entry>3</entry>
              <entry>400</entry>
            </row>
            <row>
              <entry>1600</entry>
              <entry>3</entry>
              <entry>330</entry>
            </row>
            <row>
              <entry>2400</entry>
              <entry>3</entry>
              <entry>369</entry>
            </row>
            <row>
              <entry>1416</entry>
              <entry>2</entry>
              <entry>232</entry>
            </row>
            <row>
              <entry>3000</entry>
              <entry>4</entry>
              <entry>540</entry>
            </row>
            <row>
              <entry>
                <m:math overflow="scroll">
                  <m:mo>⋮</m:mo>
                </m:math>
              </entry>
              <entry>
                <m:math overflow="scroll">
                  <m:mo>⋮</m:mo>
                </m:math>
              </entry>
              <entry>
                <m:math overflow="scroll">
                  <m:mo>⋮</m:mo>
                </m:math>
              </entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      <!--empty paragraphs get left behind.-->
      <para id="id141342">Here, the <m:math overflow="scroll"><m:mi>x</m:mi></m:math>'s are two-dimensional vectors in <m:math overflow="scroll"><m:msup><m:mrow><m:mi mathvariant="double-struck">R</m:mi></m:mrow><m:mn>2</m:mn></m:msup></m:math>. For instance,
<m:math overflow="scroll"><m:msubsup><m:mi>x</m:mi><m:mn>1</m:mn><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msubsup></m:math> is the living area of the <m:math overflow="scroll"><m:mi>i</m:mi></m:math>-th house in the training set, and
<m:math overflow="scroll"><m:msubsup><m:mi>x</m:mi><m:mn>2</m:mn><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msubsup></m:math> is its number of bedrooms. (In general, when designing a learning
problem, it will be up to you to decide what features to choose, so if you
are out in Portland gathering housing data, you might also decide to include
other features such as whether each house has a fireplace, the number of
bathrooms, and so on. We'll say more about feature selection later, but
for now let's take the features as given.)</para>
      <para id="id141424">To perform supervised learning, we must decide how we're going to
represent functions /hypotheses <m:math overflow="scroll"><m:mi>h</m:mi></m:math> in a computer. As an initial choice,
let's say we decide to approximate <m:math overflow="scroll"><m:mi>y</m:mi></m:math> as a linear function of <m:math overflow="scroll"><m:mi>x</m:mi></m:math>:</para><equation id="id141453">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>h</m:mi>
              <m:mi>θ</m:mi>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>x</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>θ</m:mi>
              <m:mn>0</m:mn>
            </m:msub>
            <m:mo>+</m:mo>
            <m:msub>
              <m:mi>θ</m:mi>
              <m:mn>1</m:mn>
            </m:msub>
            <m:msub>
              <m:mi>x</m:mi>
              <m:mn>1</m:mn>
            </m:msub>
            <m:mo>+</m:mo>
            <m:msub>
              <m:mi>θ</m:mi>
              <m:mn>2</m:mn>
            </m:msub>
            <m:msub>
              <m:mi>x</m:mi>
              <m:mn>2</m:mn>
            </m:msub>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id141520">Here, the <m:math overflow="scroll"><m:msub><m:mi>θ</m:mi><m:mi>i</m:mi></m:msub></m:math>'s are the <emphasis effect="bold">parameters</emphasis> (also called <emphasis effect="bold">weights</emphasis>)
parameterizing the space
of linear functions mapping from <m:math overflow="scroll"><m:mi mathvariant="script">X</m:mi></m:math> to <m:math overflow="scroll"><m:mi mathvariant="script">Y</m:mi></m:math>. When there is no
risk of confusion, we will drop the <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> subscript in <m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>,
and write it more simply as <m:math overflow="scroll"><m:mrow><m:mi>h</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:math>. To simplify our notation, we also
introduce the convention of letting <m:math overflow="scroll"><m:mrow><m:msub><m:mi>x</m:mi><m:mn>0</m:mn></m:msub><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math> (this is the
<emphasis effect="bold">intercept term</emphasis>), so that</para>
      <equation id="id141640">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>h</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>x</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>0</m:mn>
              </m:mrow>
              <m:mi>n</m:mi>
            </m:munderover>
            <m:msub>
              <m:mi>θ</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:msub>
              <m:mi>x</m:mi>
              <m:mi>i</m:mi>
            </m:msub>
            <m:mo>=</m:mo>
            <m:msup>
              <m:mi>θ</m:mi>
              <m:mi>T</m:mi>
            </m:msup>
            <m:mi>x</m:mi>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id141705">where on the right-hand side above we are viewing <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> and <m:math overflow="scroll"><m:mi>x</m:mi></m:math> both as vectors, and
here <m:math overflow="scroll"><m:mi>n</m:mi></m:math> is the number of input variables (not counting <m:math overflow="scroll"><m:msub><m:mi>x</m:mi><m:mn>0</m:mn></m:msub></m:math>).</para>
      <para id="id141748">Now, given a training set, how do we pick, or learn, the parameters <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>?
One reasonable method seems to be to make <m:math overflow="scroll"><m:mrow><m:mi>h</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:math> close to <m:math overflow="scroll"><m:mi>y</m:mi></m:math>, at least
for the training examples we have. To formalize this, we will define a
function that measures, for each value of the <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>'s, how close
the <m:math overflow="scroll"><m:mrow><m:mi>h</m:mi><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:math>'s are to the corresponding <m:math overflow="scroll"><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>'s. We define the <emphasis effect="bold">cost function</emphasis>:</para>
      <equation id="id141842">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>J</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>θ</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mfrac>
              <m:mn>1</m:mn>
              <m:mn>2</m:mn>
            </m:mfrac>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>m</m:mi>
            </m:munderover>
            <m:msup>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msub>
                  <m:mi>h</m:mi>
                  <m:mi>θ</m:mi>
                </m:msub>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msup>
                    <m:mi>x</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>i</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:msup>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mo>-</m:mo>
                <m:msup>
                  <m:mi>y</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>i</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:msup>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mn>2</m:mn>
            </m:msup>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id141940">If you've seen linear regression before, you may recognize this as the
familiar least-squares cost function that gives rise to the
<emphasis effect="bold">ordinary least squares</emphasis> regression model. Whether or not you have
seen it previously, let's keep going, and we'll eventually show this to
be a special case of a much broader family of algorithms.</para>
    </section>
    <section id="cid2">
      <title>LMS algorithm</title>
      <para id="id141963">We want to choose <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> so as to minimize <m:math overflow="scroll"><m:mrow><m:mi>J</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>. To do so, let's use a
search algorithm that starts with some “initial guess” for <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>, and that
repeatedly changes <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> to make <m:math overflow="scroll"><m:mrow><m:mi>J</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math> smaller, until hopefully we converge
to a value of <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> that minimizes <m:math overflow="scroll"><m:mrow><m:mi>J</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>. Specifically, let's
consider the <emphasis effect="bold">gradient descent</emphasis> algorithm, which starts with some
initial <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>, and repeatedly performs the update:</para>
      <equation id="id142068">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>θ</m:mi>
              <m:mi>j</m:mi>
            </m:msub>
            <m:mo>:</m:mo>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>θ</m:mi>
              <m:mi>j</m:mi>
            </m:msub>
            <m:mo>-</m:mo>
            <m:mi>α</m:mi>
            <m:mfrac>
              <m:mi>∂</m:mi>
              <m:mrow>
                <m:mi>∂</m:mi>
                <m:msub>
                  <m:mi>θ</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
              </m:mrow>
            </m:mfrac>
            <m:mi>J</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>θ</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id142130">(This update is simultaneously performed for all values of <m:math overflow="scroll"><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>n</m:mi></m:mrow></m:math>.)
Here, <m:math overflow="scroll"><m:mi>α</m:mi></m:math> is called the <emphasis effect="bold">learning rate</emphasis>. This is a very natural
algorithm that repeatedly takes a step in the direction of steepest
decrease of <m:math overflow="scroll"><m:mi>J</m:mi></m:math>.</para>
      <para id="id142184">In order to implement this algorithm, we have to work out what is the partial
derivative term on the right hand side. Let's first work it out for the
case of if we have only one training example <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:math>, so that we can neglect
the sum in the definition of <m:math overflow="scroll"><m:mi>J</m:mi></m:math>. We have:</para>
      <equation id="id142216">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mfrac>
                    <m:mi>∂</m:mi>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:msub>
                        <m:mi>θ</m:mi>
                        <m:mi>j</m:mi>
                      </m:msub>
                    </m:mrow>
                  </m:mfrac>
                  <m:mi>J</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>θ</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfrac>
                    <m:mi>∂</m:mi>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:msub>
                        <m:mi>θ</m:mi>
                        <m:mi>j</m:mi>
                      </m:msub>
                    </m:mrow>
                  </m:mfrac>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:mn>2</m:mn>
                  </m:mfrac>
                  <m:msup>
                    <m:mfenced separators="" open="(" close=")">
                      <m:msub>
                        <m:mi>h</m:mi>
                        <m:mi>θ</m:mi>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>x</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mo>-</m:mo>
                      <m:mi>y</m:mi>
                    </m:mfenced>
                    <m:mn>2</m:mn>
                  </m:msup>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mn>2</m:mn>
                  <m:mo>·</m:mo>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:mn>2</m:mn>
                  </m:mfrac>
                  <m:mfenced separators="" open="(" close=")">
                    <m:msub>
                      <m:mi>h</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>x</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>-</m:mo>
                    <m:mi>y</m:mi>
                  </m:mfenced>
                  <m:mo>·</m:mo>
                  <m:mfrac>
                    <m:mi>∂</m:mi>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:msub>
                        <m:mi>θ</m:mi>
                        <m:mi>j</m:mi>
                      </m:msub>
                    </m:mrow>
                  </m:mfrac>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>h</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>x</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>-</m:mo>
                    <m:mi>y</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfenced separators="" open="(" close=")">
                    <m:msub>
                      <m:mi>h</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>x</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>-</m:mo>
                    <m:mi>y</m:mi>
                  </m:mfenced>
                  <m:mo>·</m:mo>
                  <m:mfrac>
                    <m:mi>∂</m:mi>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:msub>
                        <m:mi>θ</m:mi>
                        <m:mi>j</m:mi>
                      </m:msub>
                    </m:mrow>
                  </m:mfrac>
                  <m:mfenced separators="" open="(" close=")">
                    <m:munderover>
                      <m:mo>∑</m:mo>
                      <m:mrow>
                        <m:mi>i</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>0</m:mn>
                      </m:mrow>
                      <m:mi>n</m:mi>
                    </m:munderover>
                    <m:msub>
                      <m:mi>θ</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:msub>
                      <m:mi>x</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mo>-</m:mo>
                    <m:mi>y</m:mi>
                  </m:mfenced>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfenced separators="" open="(" close=")">
                    <m:msub>
                      <m:mi>h</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>x</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>-</m:mo>
                    <m:mi>y</m:mi>
                  </m:mfenced>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id142551">For a single training example, this gives the update rule:<footnote id="uid3">We use the
notation “<m:math overflow="scroll"><m:mrow><m:mi>a</m:mi><m:mo>:</m:mo><m:mo>=</m:mo><m:mi>b</m:mi></m:mrow></m:math>” to denote an operation (in a computer program) in
which we <emphasis effect="italics">set</emphasis> the value of a variable <m:math overflow="scroll"><m:mi>a</m:mi></m:math> to be equal to the value of <m:math overflow="scroll"><m:mi>b</m:mi></m:math>. In other
words, this operation overwrites <m:math overflow="scroll"><m:mi>a</m:mi></m:math> with the value of <m:math overflow="scroll"><m:mi>b</m:mi></m:math>. In contrast, we will
write “<m:math overflow="scroll"><m:mrow><m:mi>a</m:mi><m:mo>=</m:mo><m:mi>b</m:mi></m:mrow></m:math>” when we are asserting a statement of fact, that the value of <m:math overflow="scroll"><m:mi>a</m:mi></m:math> is
equal to the value of <m:math overflow="scroll"><m:mi>b</m:mi></m:math>.</footnote></para>
      <equation id="id142655">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>θ</m:mi>
              <m:mi>j</m:mi>
            </m:msub>
            <m:mo>:</m:mo>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>θ</m:mi>
              <m:mi>j</m:mi>
            </m:msub>
            <m:mo>+</m:mo>
            <m:mi>α</m:mi>
            <m:mfenced separators="" open="(" close=")">
              <m:msup>
                <m:mi>y</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>i</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:msup>
              <m:mo>-</m:mo>
              <m:msub>
                <m:mi>h</m:mi>
                <m:mi>θ</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msup>
                  <m:mi>x</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>i</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:msup>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:mfenced>
            <m:msubsup>
              <m:mi>x</m:mi>
              <m:mi>j</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>i</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msubsup>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id142754">The rule is called the <emphasis effect="bold">LMS</emphasis> update rule (LMS stands for “least mean squares”),
and is also known as the <emphasis effect="bold">Widrow-Hoff</emphasis> learning rule.
This rule has several properties that seem natural and intuitive. For instance, the
magnitude of the update is proportional to
the <emphasis effect="bold">error</emphasis> term
<m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>-</m:mo><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow></m:math>; thus, for instance, if we are encountering a training
example on which our prediction nearly matches the actual value of <m:math overflow="scroll"><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>,
then we find that there is little need to change the parameters; in contrast,
a larger change to the parameters will be made if our prediction
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:mrow></m:math> has a large error (i.e., if it is very far from <m:math overflow="scroll"><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>).</para>
      <para id="id142909">We'd derived the LMS rule for when there was only a single training example. There are two
ways to modify this method for a training set of more than one example. The first is
replace it with the following algorithm:</para>
      <list id="id142914" display="block" list-type="enumerated">
        <item id="uid4"><label/>Repeat until convergence <m:math overflow="scroll"><m:mo>{</m:mo></m:math><list id="id142938" display="block" list-type="enumerated"><item id="uid5"><label/><m:math overflow="scroll"><m:mrow><m:msub><m:mi>θ</m:mi><m:mi>j</m:mi></m:msub><m:mo>:</m:mo><m:mo>=</m:mo><m:msub><m:mi>θ</m:mi><m:mi>j</m:mi></m:msub><m:mo>+</m:mo><m:mi>α</m:mi><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>m</m:mi></m:msubsup><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>-</m:mo><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:mfenced><m:msubsup><m:mi>x</m:mi><m:mi>j</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msubsup></m:mrow></m:math>
 (for every <m:math overflow="scroll"><m:mi>j</m:mi></m:math>).
</item></list></item>
        <item id="uid6">
          <label/>
          <m:math overflow="scroll">
            <m:mo>}</m:mo>
          </m:math>
        </item>
      </list>
      <para id="id143096">The reader can easily verify that the quantity in the summation in the update rule above
is just
<m:math overflow="scroll"><m:mrow><m:mi>∂</m:mi><m:mi>J</m:mi><m:mrow><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow><m:mo>/</m:mo><m:mi>∂</m:mi><m:msub><m:mi>θ</m:mi><m:mi>j</m:mi></m:msub></m:mrow></m:math> (for the original definition of <m:math overflow="scroll"><m:mi>J</m:mi></m:math>). So,
this is simply gradient descent on the original cost function <m:math overflow="scroll"><m:mi>J</m:mi></m:math>. This method
looks at every example in the entire training set on every step, and is
called <emphasis effect="bold">batch gradient descent</emphasis>. Note that, while gradient descent can
be susceptible to local minima in general, the optimization problem we have
posed here for linear regression has only one global, and no other local, optima; thus
gradient descent always converges (assuming the learning rate <m:math overflow="scroll"><m:mi>α</m:mi></m:math> is not too large)
to the global minimum. Indeed, <m:math overflow="scroll"><m:mi>J</m:mi></m:math> is a convex quadratic function. Here is an
example of gradient descent as it is run to minimize a quadratic function.</para>
      <figure id="uid7"><media id="uid7_media" alt="a distribution where most are around the center with a line of points leading outside">
          <image mime-type="image/png" src="../../media/quadracticGD20.png" id="uid7_onlineimage" width="471"><!-- NOTE: attribute width changes image size online (pixels). original width is 471. --></image>
          <image mime-type="application/postscript" for="pdf" print-width="3.5in" src="../../media/quadracticGD20.eps" id="uid7_printimage"/>
        </media>
      </figure><para id="id143186">The ellipses shown above are the contours of a quadratic function. Also
shown is the trajectory taken by gradient descent, which was initialized
at (48,30). The <m:math overflow="scroll"><m:mi>x</m:mi></m:math>'s in the figure (joined by straight lines) mark the
successive values of <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> that gradient descent went through.</para>
      <para id="id143209">When we run batch gradient descent to fit <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> on our previous dataset,
to learn to predict housing price as a function of living area, we
obtain <m:math overflow="scroll"><m:mrow><m:msub><m:mi>θ</m:mi><m:mn>0</m:mn></m:msub><m:mo>=</m:mo><m:mn>71</m:mn><m:mo>.</m:mo><m:mn>27</m:mn></m:mrow></m:math>, <m:math overflow="scroll"><m:mrow><m:msub><m:mi>θ</m:mi><m:mn>1</m:mn></m:msub><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>.</m:mo><m:mn>1345</m:mn></m:mrow></m:math>. If we plot
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> as a function of <m:math overflow="scroll"><m:mi>x</m:mi></m:math> (area), along with the training data, we
obtain the
following figure:</para>
      <figure id="uid8"><media id="uid8_media" alt="the housing prices graph with a line drawn to represent the distribution. vaguely x=2y">
          <image mime-type="image/png" src="../../media/housingGDConverged.png" id="uid8_onlineimage" width="505"><!-- NOTE: attribute width changes image size online (pixels). original width is 505. --></image>
          <image mime-type="application/postscript" for="pdf" print-width="3.5in" src="../../media/housingGDConverged.eps" id="uid8_printimage"/>
        </media>
      </figure><para id="id143312">If the number of bedrooms were included as one of the input features as well,
we get <m:math overflow="scroll"><m:mrow><m:msub><m:mi>θ</m:mi><m:mn>0</m:mn></m:msub><m:mo>=</m:mo><m:mn>89</m:mn><m:mo>.</m:mo><m:mn>60</m:mn><m:mo>,</m:mo><m:msub><m:mi>θ</m:mi><m:mn>1</m:mn></m:msub><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>.</m:mo><m:mn>1392</m:mn></m:mrow></m:math>, <m:math overflow="scroll"><m:mrow><m:msub><m:mi>θ</m:mi><m:mn>2</m:mn></m:msub><m:mo>=</m:mo><m:mo>-</m:mo><m:mn>8</m:mn><m:mo>.</m:mo><m:mn>738</m:mn></m:mrow></m:math>.</para>
      <para id="id143385">The above results were obtained with batch gradient descent. There is an
alternative to batch gradient descent that also works very well.
Consider the following algorithm:</para>
      <list id="id143390" display="block" list-type="enumerated">
        <item id="uid9"><label/>Loop <m:math overflow="scroll"><m:mo>{</m:mo></m:math><list id="id143414" display="block" list-type="enumerated"><item id="uid10"><label/>for i=1 to m, <m:math overflow="scroll"><m:mo>{</m:mo></m:math><list id="id143438" display="block" list-type="enumerated"><item id="uid11"><label/><m:math overflow="scroll"><m:mrow><m:msub><m:mi>θ</m:mi><m:mi>j</m:mi></m:msub><m:mo>:</m:mo><m:mo>=</m:mo><m:msub><m:mi>θ</m:mi><m:mi>j</m:mi></m:msub><m:mo>+</m:mo><m:mi>α</m:mi><m:mfenced separators="" open="(" close=")"><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>-</m:mo><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:mfenced><m:msubsup><m:mi>x</m:mi><m:mi>j</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msubsup></m:mrow></m:math>
 (for every <m:math overflow="scroll"><m:mi>j</m:mi></m:math>).
</item></list></item><item id="uid12"><label/><m:math overflow="scroll"><m:mo>}</m:mo></m:math></item></list></item>
        <item id="uid13">
          <label/>
          <m:math overflow="scroll">
            <m:mo>}</m:mo>
          </m:math>
        </item>
      </list>
      <para id="id143601">In this algorithm, we repeatedly run through the training set, and
each time we encounter a training example, we update the parameters
according to the gradient of the error with respect to that single training
example only. This algorithm is called <emphasis effect="bold">stochastic gradient descent</emphasis>
(also <emphasis effect="bold">incremental gradient descent</emphasis>).
Whereas batch gradient descent has to scan through the entire training set
before taking a single step—a costly operation if <m:math overflow="scroll"><m:mi>m</m:mi></m:math> is large—stochastic
gradient descent can start making progress right away, and continues to make
progress with each example it looks at. Often, stochastic gradient descent
gets <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> “close” to the minimum much faster than batch
gradient descent. (Note however that it may never “converge” to the minimum,
and the parameters <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> will keep oscillating around the minimum
of <m:math overflow="scroll"><m:mrow><m:mi>J</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>; but in practice most of the values near the minimum will be
reasonably good approximations to the true minimum.<footnote id="uid14">While it is
more common to run stochastic gradient descent as we have described it and with a
fixed learning rate <m:math overflow="scroll"><m:mi>α</m:mi></m:math>, by slowly letting the learning rate <m:math overflow="scroll"><m:mi>α</m:mi></m:math>
decrease to zero as the algorithm runs, it is also possible to ensure that
the parameters will converge to the global minimum rather then merely oscillate
around the minimum.</footnote>) For these reasons, particularly when the training
set is large, stochastic gradient descent is often preferred over batch
gradient descent.</para>
    </section>
    <section id="cid3">
      <title>The normal equations</title>
      <para id="id143711">Gradient descent gives one way of minimizing <m:math overflow="scroll"><m:mi>J</m:mi></m:math>. Let's discuss a second
way of doing so, this time performing the minimization explicitly
and without resorting to an iterative algorithm. In this method, we will
minimize <m:math overflow="scroll"><m:mi>J</m:mi></m:math> by explicitly taking its derivatives with respect to the <m:math overflow="scroll"><m:msub><m:mi>θ</m:mi><m:mi>j</m:mi></m:msub></m:math>'s,
and setting them to zero. To enable us to do this without having to write reams
of algebra and pages full of matrices of derivatives, let's introduce some
notation for doing calculus with matrices.</para>
      <section id="uid15">
        <title>Matrix derivatives</title>
        <para id="id143759">For a function <m:math overflow="scroll"><m:mrow><m:mi>f</m:mi><m:mo>:</m:mo><m:msup><m:mrow><m:mi mathvariant="double-struck">R</m:mi></m:mrow><m:mrow><m:mi>m</m:mi><m:mo>×</m:mo><m:mi>n</m:mi></m:mrow></m:msup><m:mo>↦</m:mo><m:mi mathvariant="double-struck">R</m:mi></m:mrow></m:math> mapping from
<m:math overflow="scroll"><m:mi>m</m:mi></m:math>-by-<m:math overflow="scroll"><m:mi>n</m:mi></m:math> matrices to the real numbers, we define the derivative
of <m:math overflow="scroll"><m:mi>f</m:mi></m:math> with respect to <m:math overflow="scroll"><m:mi>A</m:mi></m:math> to be:
</para>
        <equation id="id143988"><m:math overflow="scroll" mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>∇</m:mi>
                <m:mi>A</m:mi>
              </m:msub>
              <m:mi>f</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>A</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mfenced separators="" open="[" close="]">
               <m:mtable>
    <m:mtr>
      <m:mtd>
        <m:mfrac>
         <m:mrow>
        <m:mn>∂</m:mn>
        <m:mi>f</m:mi>
         </m:mrow>
         <m:mrow>
        <m:mn>∂</m:mn>
        <m:msub>
         <m:mi>A</m:mi>
         <m:mn>11</m:mn>
        </m:msub>
         </m:mrow>
        </m:mfrac>
      </m:mtd>
      <m:mtd>
        <m:mn>⋯</m:mn>
      </m:mtd>
      <m:mtd>
                <m:mfrac>
         <m:mrow>
        <m:mn>∂</m:mn>
        <m:mi>f</m:mi>
         </m:mrow>
         <m:mrow>
        <m:mn>∂</m:mn>
        <m:msub>
         <m:mi>A</m:mi>
         <m:mn>1n</m:mn>
        </m:msub>
         </m:mrow>
        </m:mfrac>
      </m:mtd>
    </m:mtr>

    <m:mtr>
      <m:mtd>
        <m:mn>⋮</m:mn>
      </m:mtd>
      <m:mtd>
        <m:mn>⋱</m:mn>
      </m:mtd>
      <m:mtd>
        <m:mn>⋮</m:mn>
      </m:mtd>
    </m:mtr>

    <m:mtr>
      <m:mtd>
                <m:mfrac>
         <m:mrow>
        <m:mn>∂</m:mn>
        <m:mi>f</m:mi>
         </m:mrow>
         <m:mrow>
        <m:mn>∂</m:mn>
        <m:msub>
         <m:mi>A</m:mi>
         <m:mn>m1</m:mn>
        </m:msub>
         </m:mrow>
        </m:mfrac>
      </m:mtd>
      <m:mtd>
        <m:mn>⋯</m:mn>
      </m:mtd>
      <m:mtd>
                <m:mfrac>
         <m:mrow>
        <m:mn>∂</m:mn>
        <m:mi>f</m:mi>
         </m:mrow>
         <m:mrow>
        <m:mn>∂</m:mn>
        <m:msub>
         <m:mi>A</m:mi>
         <m:mn>mn</m:mn>
        </m:msub>
         </m:mrow>
        </m:mfrac>
      </m:mtd>
    </m:mtr>
               </m:mtable>
</m:mfenced>

            </m:mrow>
          </m:math>
        </equation><para id="id144025">Thus, the gradient <m:math overflow="scroll"><m:mrow><m:msub><m:mi>∇</m:mi><m:mi>A</m:mi></m:msub><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> is itself an <m:math overflow="scroll"><m:mi>m</m:mi></m:math>-by-<m:math overflow="scroll"><m:mi>n</m:mi></m:math> matrix, whose <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow></m:math>-element is
<m:math overflow="scroll"><m:mrow><m:mi>∂</m:mi><m:mi>f</m:mi><m:mo>/</m:mo><m:mi>∂</m:mi><m:msub><m:mi>A</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:mrow></m:math>. For example, suppose
<m:math overflow="scroll">
 <m:mrow>
  <m:mi>A</m:mi>
  <m:mo>=</m:mo>
  <m:mfenced separators="" open="[" close="]">
   <m:mtable>
    <m:mtr>
   <m:mtd>
        <m:msub>
         <m:mi>A</m:mi>
         <m:mn>11</m:mn>
        </m:msub>
   </m:mtd>
   <m:mtd>
        <m:msub>
         <m:mi>A</m:mi>
         <m:mn>12</m:mn>
        </m:msub>
   </m:mtd>
    </m:mtr>
    <m:mtr>
   <m:mtd>
        <m:msub>
         <m:mi>A</m:mi>
         <m:mn>21</m:mn>
        </m:msub>
   </m:mtd>
   <m:mtd>
        <m:msub>
         <m:mi>A</m:mi>
         <m:mn>22</m:mn>
        </m:msub>
   </m:mtd>
    </m:mtr>
   </m:mtable>
  </m:mfenced>
 </m:mrow>
</m:math>


is a 2-by-2 matrix, and
the function <m:math overflow="scroll"><m:mrow><m:mi>f</m:mi><m:mo>:</m:mo><m:msup><m:mrow><m:mi mathvariant="double-struck">R</m:mi></m:mrow><m:mrow><m:mn>2</m:mn><m:mo>×</m:mo><m:mn>2</m:mn></m:mrow></m:msup><m:mo>↦</m:mo><m:mi mathvariant="double-struck">R</m:mi></m:mrow></m:math> is given by</para><equation id="id144255">
          <m:math overflow="scroll" mode="display">
            <m:mrow>
              <m:mi>f</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>A</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mfrac>
                <m:mn>3</m:mn>
                <m:mn>2</m:mn>
              </m:mfrac>
              <m:msub>
                <m:mi>A</m:mi>
                <m:mn>11</m:mn>
              </m:msub>
              <m:mo>+</m:mo>
              <m:mn>5</m:mn>
              <m:msubsup>
                <m:mi>A</m:mi>
                <m:mrow>
                  <m:mn>12</m:mn>
                </m:mrow>
                <m:mn>2</m:mn>
              </m:msubsup>
              <m:mo>+</m:mo>
              <m:msub>
                <m:mi>A</m:mi>
                <m:mn>21</m:mn>
              </m:msub>
              <m:msub>
                <m:mi>A</m:mi>
                <m:mn>22</m:mn>
              </m:msub>
              <m:mo>.</m:mo>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id144326">Here, <m:math overflow="scroll"><m:msub><m:mi>A</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math> denotes the <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow></m:math> entry of the matrix <m:math overflow="scroll"><m:mi>A</m:mi></m:math>. We then have
</para>
        <equation id="id144456"><m:math overflow="scroll" mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>∇</m:mi>
                <m:mi>A</m:mi>
              </m:msub>
              <m:mi>f</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>A</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
              <m:mfenced separators="" open="[" close="]">

   <m:mtable>
    <m:mtr>
   <m:mtd>
        <m:mfrac>
         <m:mi>3</m:mi>
         <m:mn>2</m:mn>
        </m:mfrac>
   </m:mtd>
   <m:mtd>
        <m:mn>10</m:mn>
        <m:msub>
         <m:mi>A</m:mi>
         <m:mn>12</m:mn>
        </m:msub>
   </m:mtd>
    </m:mtr>
    <m:mtr>
   <m:mtd>
        <m:msub>
         <m:mi>A</m:mi>
         <m:mn>22</m:mn>
        </m:msub>
   </m:mtd>
   <m:mtd>
        <m:msub>
         <m:mi>A</m:mi>
         <m:mn>21</m:mn>
        </m:msub>
   </m:mtd>
    </m:mtr>
   </m:mtable>

</m:mfenced>
              <m:mo>.</m:mo>
            </m:mrow>
          </m:math>
        </equation><para id="id144495">We also introduce the <emphasis effect="bold">trace</emphasis> operator,
written “<m:math overflow="scroll"><m:mi> tr </m:mi></m:math>.” For an <m:math overflow="scroll"><m:mi>n</m:mi></m:math>-by-<m:math overflow="scroll"><m:mi>n</m:mi></m:math> (square) matrix <m:math overflow="scroll"><m:mi>A</m:mi></m:math>, the trace of <m:math overflow="scroll"><m:mi>A</m:mi></m:math>
is defined to be the sum of its diagonal entries:</para>
        <equation id="id144550">
          <m:math overflow="scroll" mode="display">
            <m:mrow>
              <m:mi> tr </m:mi>
              <m:mi>A</m:mi>
              <m:mo>=</m:mo>
              <m:munderover>
                <m:mo>∑</m:mo>
                <m:mrow>
                  <m:mi>i</m:mi>
                  <m:mo>=</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
                <m:mi>n</m:mi>
              </m:munderover>
              <m:msub>
                <m:mi>A</m:mi>
                <m:mrow>
                  <m:mi>i</m:mi>
                  <m:mi>i</m:mi>
                </m:mrow>
              </m:msub>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id144592">If <m:math overflow="scroll"><m:mi>a</m:mi></m:math> is a real number (i.e., a 1-by-1 matrix), then <m:math overflow="scroll"><m:mrow><m:mi> tr </m:mi><m:mspace width="0.166667em"/><m:mi>a</m:mi><m:mo>=</m:mo><m:mi>a</m:mi></m:mrow></m:math>.
(If you haven't seen this “operator notation” before, you should
think of the trace of <m:math overflow="scroll"><m:mi>A</m:mi></m:math> as <m:math overflow="scroll"><m:mrow><m:mi> tr </m:mi><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>)</m:mo></m:mrow></m:math>, or as application of the “trace” function
to the matrix <m:math overflow="scroll"><m:mi>A</m:mi></m:math>. It's more commonly written without the parentheses, however.)</para>
        <para id="id144665">The trace operator has the property that for two matrices <m:math overflow="scroll"><m:mi>A</m:mi></m:math> and <m:math overflow="scroll"><m:mi>B</m:mi></m:math> such
that <m:math overflow="scroll"><m:mrow><m:mi>A</m:mi><m:mi>B</m:mi></m:mrow></m:math> is square, we have that <m:math overflow="scroll"><m:mrow><m:mi> tr </m:mi><m:mi>A</m:mi><m:mi>B</m:mi><m:mo>=</m:mo><m:mi> tr </m:mi><m:mi>B</m:mi><m:mi>A</m:mi></m:mrow></m:math>. (Check this yourself!)
As corollaries of this, we also have, e.g.,</para>
        <equation id="id144721">
          <m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mrow>
                    <m:mi> tr </m:mi>
                    <m:mi>A</m:mi>
                    <m:mi>B</m:mi>
                    <m:mi>C</m:mi>
                    <m:mo>=</m:mo>
                    <m:mi> tr </m:mi>
                    <m:mi>C</m:mi>
                    <m:mi>A</m:mi>
                    <m:mi>B</m:mi>
                    <m:mo>=</m:mo>
                    <m:mi> tr </m:mi>
                    <m:mi>B</m:mi>
                    <m:mi>C</m:mi>
                    <m:mi>A</m:mi>
                    <m:mo>,</m:mo>
                  </m:mrow>
                </m:mtd>
                <m:mtd/>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mrow>
                    <m:mi> tr </m:mi>
                    <m:mi>A</m:mi>
                    <m:mi>B</m:mi>
                    <m:mi>C</m:mi>
                    <m:mi>D</m:mi>
                    <m:mo>=</m:mo>
                    <m:mi> tr </m:mi>
                    <m:mi>D</m:mi>
                    <m:mi>A</m:mi>
                    <m:mi>B</m:mi>
                    <m:mi>C</m:mi>
                    <m:mo>=</m:mo>
                    <m:mi> tr </m:mi>
                    <m:mi>C</m:mi>
                    <m:mi>D</m:mi>
                    <m:mi>A</m:mi>
                    <m:mi>B</m:mi>
                    <m:mo>=</m:mo>
                    <m:mi> tr </m:mi>
                    <m:mi>B</m:mi>
                    <m:mi>C</m:mi>
                    <m:mi>D</m:mi>
                    <m:mi>A</m:mi>
                    <m:mo>.</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id144828">The following properties of the trace operator are also easily
verified. Here, <m:math overflow="scroll"><m:mi>A</m:mi></m:math> and <m:math overflow="scroll"><m:mi>B</m:mi></m:math> are square matrices, and <m:math overflow="scroll"><m:mi>a</m:mi></m:math> is a real number:</para>
        <equation id="id144862">
          <m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mrow>
                    <m:mi> tr </m:mi>
                    <m:mi>A</m:mi>
                    <m:mo>=</m:mo>
                    <m:mi> tr </m:mi>
                    <m:msup>
                      <m:mi>A</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                  </m:mrow>
                </m:mtd>
                <m:mtd/>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mrow>
                    <m:mi> tr </m:mi>
                    <m:mo>(</m:mo>
                    <m:mi>A</m:mi>
                    <m:mo>+</m:mo>
                    <m:mi>B</m:mi>
                    <m:mo>)</m:mo>
                    <m:mo>=</m:mo>
                    <m:mi> tr </m:mi>
                    <m:mi>A</m:mi>
                    <m:mo>+</m:mo>
                    <m:mi> tr </m:mi>
                    <m:mi>B</m:mi>
                  </m:mrow>
                </m:mtd>
                <m:mtd/>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mrow>
                    <m:mi> tr </m:mi>
                    <m:mspace width="0.166667em"/>
                    <m:mi>a</m:mi>
                    <m:mi>A</m:mi>
                    <m:mo>=</m:mo>
                    <m:mi>a</m:mi>
                    <m:mi> tr </m:mi>
                    <m:mi>A</m:mi>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id144950">We now state without proof some facts of matrix derivatives (we won't need some
of these until later this quarter). <link target-id="uid16"/> applies only
to non-singular square matrices <m:math overflow="scroll"><m:mi>A</m:mi></m:math>, where <m:math overflow="scroll"><m:mrow><m:mo>|</m:mo><m:mi>A</m:mi><m:mo>|</m:mo></m:mrow></m:math> denotes the determinant of <m:math overflow="scroll"><m:mi>A</m:mi></m:math>.
We have:
</para><equation id="uid16">
          <m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:msub>
                      <m:mi>∇</m:mi>
                      <m:mi>A</m:mi>
                    </m:msub>
                    <m:mi> tr </m:mi>
                    <m:mi>A</m:mi>
                    <m:mi>B</m:mi>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:msup>
                    <m:mi>B</m:mi>
                    <m:mi>T</m:mi>
                  </m:msup>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:msub>
                      <m:mi>∇</m:mi>
                      <m:msup>
                        <m:mi>A</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                    </m:msub>
                    <m:mi>f</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>A</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:msup>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>∇</m:mi>
                        <m:mi>A</m:mi>
                      </m:msub>
                      <m:mi>f</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>A</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mi>T</m:mi>
                  </m:msup>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:msub>
                      <m:mi>∇</m:mi>
                      <m:mi>A</m:mi>
                    </m:msub>
                    <m:mi> tr </m:mi>
                    <m:mi>A</m:mi>
                    <m:mi>B</m:mi>
                    <m:msup>
                      <m:mi>A</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mi>C</m:mi>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mi>C</m:mi>
                    <m:mi>A</m:mi>
                    <m:mi>B</m:mi>
                    <m:mo>+</m:mo>
                    <m:msup>
                      <m:mi>C</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mi>A</m:mi>
                    <m:msup>
                      <m:mi>B</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:msub>
                      <m:mi>∇</m:mi>
                      <m:mi>A</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>|</m:mo>
                      <m:mi>A</m:mi>
                      <m:mo>|</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mrow>
                      <m:mo>|</m:mo>
                      <m:mi>A</m:mi>
                      <m:mo>|</m:mo>
                    </m:mrow>
                    <m:msup>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msup>
                          <m:mi>A</m:mi>
                          <m:mrow>
                            <m:mo>-</m:mo>
                            <m:mn>1</m:mn>
                          </m:mrow>
                        </m:msup>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mo>.</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id145233">To make our matrix notation more concrete, let us now explain in detail
the meaning of the first of these equations. Suppose we have some fixed
matrix <m:math overflow="scroll"><m:mrow><m:mi>B</m:mi><m:mo>∈</m:mo><m:msup><m:mrow><m:mi mathvariant="double-struck">R</m:mi></m:mrow><m:mrow><m:mi>n</m:mi><m:mo>×</m:mo><m:mi>m</m:mi></m:mrow></m:msup></m:mrow></m:math>. We can then define a function <m:math overflow="scroll"><m:mrow><m:mi>f</m:mi><m:mo>:</m:mo><m:msup><m:mrow><m:mi mathvariant="double-struck">R</m:mi></m:mrow><m:mrow><m:mi>m</m:mi><m:mo>×</m:mo><m:mi>n</m:mi></m:mrow></m:msup><m:mo>↦</m:mo><m:mi mathvariant="double-struck">R</m:mi></m:mrow></m:math> according
to <m:math overflow="scroll"><m:mrow><m:mi>f</m:mi><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi> tr </m:mi><m:mi>A</m:mi><m:mi>B</m:mi></m:mrow></m:math>. Note that this definition makes sense, because if
<m:math overflow="scroll"><m:mrow><m:mi>A</m:mi><m:mo>∈</m:mo><m:msup><m:mrow><m:mi mathvariant="double-struck">R</m:mi></m:mrow><m:mrow><m:mi>m</m:mi><m:mo>×</m:mo><m:mi>n</m:mi></m:mrow></m:msup></m:mrow></m:math>, then <m:math overflow="scroll"><m:mrow><m:mi>A</m:mi><m:mi>B</m:mi></m:mrow></m:math> is a square matrix, and we can apply the
trace operator to it; thus, <m:math overflow="scroll"><m:mi>f</m:mi></m:math> does indeed map from <m:math overflow="scroll"><m:msup><m:mrow><m:mi mathvariant="double-struck">R</m:mi></m:mrow><m:mrow><m:mi>m</m:mi><m:mo>×</m:mo><m:mi>n</m:mi></m:mrow></m:msup></m:math> to <m:math overflow="scroll"><m:mi mathvariant="double-struck">R</m:mi></m:math>.
We can then apply our definition of matrix derivatives
to find <m:math overflow="scroll"><m:mrow><m:msub><m:mi>∇</m:mi><m:mi>A</m:mi></m:msub><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>A</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>, which will itself by an <m:math overflow="scroll"><m:mi>m</m:mi></m:math>-by-<m:math overflow="scroll"><m:mi>n</m:mi></m:math> matrix.
<link target-id="uid16"/> above states that the <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow></m:math> entry of this
matrix will be given by the <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow></m:math>-entry of <m:math overflow="scroll"><m:msup><m:mi>B</m:mi><m:mi>T</m:mi></m:msup></m:math>, or equivalently, by
<m:math overflow="scroll"><m:msub><m:mi>B</m:mi><m:mrow><m:mi>j</m:mi><m:mi>i</m:mi></m:mrow></m:msub></m:math>.</para><para id="id145530">The proofs of the first three equations in <link target-id="uid16"/> are reasonably simple,
and are left as
an exercise to the reader.
The fourth equation in <link target-id="uid16"/>
can be derived using the adjoint
representation of the inverse of a matrix.<footnote id="uid17">If we define
<m:math overflow="scroll"><m:msup><m:mi>A</m:mi><m:mo>'</m:mo></m:msup></m:math> to be the matrix whose <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>,</m:mo><m:mi>j</m:mi><m:mo>)</m:mo></m:mrow></m:math> element is <m:math overflow="scroll"><m:msup><m:mrow><m:mo>(</m:mo><m:mo>-</m:mo><m:mn>1</m:mn><m:mo>)</m:mo></m:mrow><m:mrow><m:mi>i</m:mi><m:mo>+</m:mo><m:mi>j</m:mi></m:mrow></m:msup></m:math> times the
determinant of the square matrix resulting from deleting row <m:math overflow="scroll"><m:mi>i</m:mi></m:math> and
column <m:math overflow="scroll"><m:mi>j</m:mi></m:math> from <m:math overflow="scroll"><m:mi>A</m:mi></m:math>, then it can be proved that <m:math overflow="scroll"><m:mrow><m:msup><m:mi>A</m:mi><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:mo>=</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>A</m:mi><m:mo>'</m:mo></m:msup><m:mo>)</m:mo></m:mrow><m:mi>T</m:mi></m:msup><m:mo>/</m:mo><m:mrow><m:mo>|</m:mo><m:mi>A</m:mi><m:mo>|</m:mo></m:mrow></m:mrow></m:math>.
(You can check that this is consistent with the standard way
of finding <m:math overflow="scroll"><m:msup><m:mi>A</m:mi><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup></m:math> when <m:math overflow="scroll"><m:mi>A</m:mi></m:math> is a 2-by-2 matrix. If you want to see a
proof of this more general result, see an intermediate or advanced
linear algebra text, such as Charles Curtis, 1991, <emphasis effect="italics">Linear Algebra</emphasis>, Springer.)
This shows that <m:math overflow="scroll"><m:mrow><m:msup><m:mi>A</m:mi><m:mo>'</m:mo></m:msup><m:mo>=</m:mo><m:mrow><m:mo>|</m:mo><m:mi>A</m:mi><m:mo>|</m:mo></m:mrow><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>A</m:mi><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:mo>)</m:mo></m:mrow><m:mi>T</m:mi></m:msup></m:mrow></m:math>. Also, the determinant of a matrix
can be written <m:math overflow="scroll"><m:mrow><m:mrow><m:mo>|</m:mo><m:mi>A</m:mi><m:mo>|</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mo>∑</m:mo><m:mi>j</m:mi></m:msub><m:msub><m:mi>A</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub><m:msubsup><m:mi>A</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow><m:mo>'</m:mo></m:msubsup></m:mrow></m:math>.
Since <m:math overflow="scroll"><m:msub><m:mrow><m:mo>(</m:mo><m:msup><m:mi>A</m:mi><m:mo>'</m:mo></m:msup><m:mo>)</m:mo></m:mrow><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math> does not depend on <m:math overflow="scroll"><m:msub><m:mi>A</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub></m:math> (as can be seen from its definition),
this implies that <m:math overflow="scroll"><m:mrow><m:mrow><m:mo>(</m:mo><m:mi>∂</m:mi><m:mo>/</m:mo><m:mi>∂</m:mi><m:msub><m:mi>A</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow></m:msub><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>|</m:mo><m:mi>A</m:mi><m:mo>|</m:mo></m:mrow><m:mo>=</m:mo><m:msubsup><m:mi>A</m:mi><m:mrow><m:mi>i</m:mi><m:mi>j</m:mi></m:mrow><m:mo>'</m:mo></m:msubsup></m:mrow></m:math>. Putting all
this together shows the result.</footnote></para></section>
      <section id="uid18">
        <title>Least squares revisited</title>
        <para id="id145929">Armed with the tools of matrix derivatives, let us now proceed to find
in closed-form the value of <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> that minimizes <m:math overflow="scroll"><m:mrow><m:mi>J</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>. We begin
by re-writing <m:math overflow="scroll"><m:mi>J</m:mi></m:math> in matrix-vectorial notation.</para>
        <para id="id145969">Given a training set, define the <emphasis effect="bold">design matrix</emphasis><m:math overflow="scroll"><m:mi>X</m:mi></m:math> to be the
<m:math overflow="scroll"><m:mi>m</m:mi></m:math>-by-<m:math overflow="scroll"><m:mi>n</m:mi></m:math> matrix (actually <m:math overflow="scroll"><m:mi>m</m:mi></m:math>-by-<m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:math>, if we include the intercept term)
that contains the training examples' input values in its rows:
</para>
        <equation id="id146094"><m:math overflow="scroll" mode="display">
            <m:mrow>
              <m:mi>X</m:mi>
              <m:mo>=</m:mo>
<m:mfenced separators="" open="[" close="]">
 <m:mtable>
  <m:mtr>
   <m:mtd><m:mn>—</m:mn>
   </m:mtd>
   <m:mtd>
<m:msup>
 <m:mfenced separators="" open="(" close=")">
  <m:mi>x</m:mi>
  <m:mfenced separators="" open="(" close=")">
   <m:mn>1</m:mn>
  </m:mfenced>
 </m:mfenced>
 <m:mi>T</m:mi>
</m:msup>
   </m:mtd>
   <m:mtd><m:mn>—</m:mn>
   </m:mtd>
  </m:mtr>
  <m:mtr>
   <m:mtd><m:mn>—</m:mn>
   </m:mtd>
   <m:mtd>
<m:msup>
 <m:mfenced separators="" open="(" close=")">
  <m:mi>x</m:mi>
  <m:mfenced separators="" open="(" close=")">
   <m:mn>2</m:mn>
  </m:mfenced>
 </m:mfenced>
 <m:mi>T</m:mi>
</m:msup>
   </m:mtd>
   <m:mtd><m:mn>—</m:mn>
   </m:mtd>
  </m:mtr>
  <m:mtr>
   <m:mtd>
   </m:mtd>
   <m:mtd><m:mn>⋮</m:mn>
   </m:mtd>
   <m:mtd>
   </m:mtd>
  </m:mtr>
  <m:mtr>
   <m:mtd><m:mn>—</m:mn>
   </m:mtd>
   <m:mtd>
<m:msup>
 <m:mfenced separators="" open="(" close=")">
  <m:mi>x</m:mi>
  <m:mfenced separators="" open="(" close=")">
   <m:mi>m</m:mi>
  </m:mfenced>
 </m:mfenced>
 <m:mi>T</m:mi>
</m:msup>
   </m:mtd>
   <m:mtd><m:mn>—</m:mn>
   </m:mtd>
  </m:mtr>
 </m:mtable>
</m:mfenced>
              <m:mo>.</m:mo>
            </m:mrow>
          </m:math>
        </equation><para id="id146118">Also, let <m:math overflow="scroll"><m:mover accent="true"><m:mi>y</m:mi><m:mo>→</m:mo></m:mover></m:math> be the <m:math overflow="scroll"><m:mi>m</m:mi></m:math>-dimensional vector containing all the
target values from the training set:
</para>
        <equation id="id146214"><m:math overflow="scroll" mode="display">
            <m:mrow>
              <m:mover accent="true">
                <m:mi>y</m:mi>
                <m:mo>→</m:mo>
              </m:mover>
              <m:mo>=</m:mo>
              <m:mfenced separators="" open="[" close="]">
 <m:mtable>
  <m:mtr>
   <m:mtd>
<m:msup>
  <m:mi>y</m:mi>
  <m:mfenced separators="" open="(" close=")">
   <m:mn>1</m:mn>
  </m:mfenced>
</m:msup>
   </m:mtd>
  </m:mtr>
  <m:mtr>
   <m:mtd>
<m:msup>
  <m:mi>y</m:mi>
  <m:mfenced separators="" open="(" close=")">
   <m:mn>2</m:mn>
  </m:mfenced>
</m:msup>
   </m:mtd>
  </m:mtr>
  <m:mtr>
   <m:mtd><m:mn>⋮</m:mn>
   </m:mtd>
  </m:mtr>
  <m:mtr>
   <m:mtd>
<m:msup>
  <m:mi>y</m:mi>
  <m:mfenced separators="" open="(" close=")">
   <m:mi>m</m:mi>
  </m:mfenced>
</m:msup>
   </m:mtd>
  </m:mtr>
 </m:mtable>
</m:mfenced>

              <m:mo>.</m:mo>
            </m:mrow>
          </m:math>
        </equation><para id="id146244">Now, since <m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow><m:mi>T</m:mi></m:msup><m:mi>θ</m:mi></m:mrow></m:math>, we can easily verify that
</para>
        <equation id="id146472"><m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:mi>X</m:mi>
                    <m:mi>θ</m:mi>
                    <m:mo>-</m:mo>
                    <m:mover accent="true">
                      <m:mi>y</m:mi>
                      <m:mo>→</m:mo>
                    </m:mover>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>

<m:mfenced separators="" open="[" close="]">
 <m:mtable>
  <m:mtr>
   <m:mtd>
<m:msup>
  <m:mfenced separators="" open="(" close=")">
   <m:msup>
    <m:mi>x</m:mi>
    <m:mfenced separators="" open="(" close=")">
     <m:mn>1</m:mn>
    </m:mfenced>
   </m:msup>
  </m:mfenced>
  <m:mi>T</m:mi>
</m:msup>
<m:mo>θ</m:mo>
   </m:mtd>
  </m:mtr>
  <m:mtr>
   <m:mtd><m:mn>⋮</m:mn>
   </m:mtd>
  </m:mtr>
  <m:mtr>
   <m:mtd>
<m:msup>
  <m:mfenced separators="" open="(" close=")">
   <m:msup>
    <m:mi>x</m:mi>
    <m:mfenced separators="" open="(" close=")">
     <m:mi>m</m:mi>
    </m:mfenced>
   </m:msup>
  </m:mfenced>
  <m:mi>T</m:mi>
</m:msup>
<m:mo>θ</m:mo>
   </m:mtd>
  </m:mtr>
 </m:mtable>
</m:mfenced>

                    <m:mo>-</m:mo>

<m:mfenced separators="" open="[" close="]">
 <m:mtable>
  <m:mtr>
   <m:mtd>
<m:msup>
  <m:mi>y</m:mi>
  <m:mfenced separators="" open="(" close=")">
   <m:mn>1</m:mn>
  </m:mfenced>
</m:msup>
   </m:mtd>
  </m:mtr>
  <m:mtr>
   <m:mtd><m:mn>⋮</m:mn>
   </m:mtd>
  </m:mtr>
  <m:mtr>
   <m:mtd>
<m:msup>
  <m:mi>y</m:mi>
  <m:mfenced separators="" open="(" close=")">
   <m:mi>m</m:mi>
  </m:mfenced>
</m:msup>
   </m:mtd>
  </m:mtr>
 </m:mtable>
</m:mfenced>

                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>

<m:mfenced separators="" open="[" close="]">
 <m:mtable>
  <m:mtr>
   <m:mtd>
<m:msub>
<m:mi>h</m:mi>
<m:mn>θ</m:mn>
</m:msub>
  <m:mfenced separators="" open="(" close=")">
   <m:msup>
    <m:mi>x</m:mi>
    <m:mfenced separators="" open="(" close=")">
     <m:mn>1</m:mn>
    </m:mfenced>
   </m:msup>
  </m:mfenced>

<m:mo>-</m:mo>
<m:msup>
  <m:mi>y</m:mi>
  <m:mfenced separators="" open="(" close=")">
   <m:mn>1</m:mn>
  </m:mfenced>
</m:msup>
   </m:mtd>
  </m:mtr>
  <m:mtr>
   <m:mtd><m:mn>⋮</m:mn>
   </m:mtd>
  </m:mtr>
  <m:mtr>
   <m:mtd>
<m:msub>
<m:mi>h</m:mi>
<m:mn>θ</m:mn>
</m:msub>
  <m:mfenced separators="" open="(" close=")">
   <m:msup>
    <m:mi>x</m:mi>
    <m:mfenced separators="" open="(" close=")">
     <m:mn>m</m:mn>
    </m:mfenced>
   </m:msup>
  </m:mfenced>

<m:mo>-</m:mo>
<m:msup>
  <m:mi>y</m:mi>
  <m:mfenced separators="" open="(" close=")">
   <m:mn>m</m:mn>
  </m:mfenced>
</m:msup>
   </m:mtd>
  </m:mtr>
 </m:mtable>
</m:mfenced>

                    <m:mo>.</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation><para id="id146548">Thus, using the fact that for a vector <m:math overflow="scroll"><m:mi>z</m:mi></m:math>, we have that <m:math overflow="scroll"><m:mrow><m:msup><m:mi>z</m:mi><m:mi>T</m:mi></m:msup><m:mi>z</m:mi><m:mo>=</m:mo><m:msub><m:mo>∑</m:mo><m:mi>i</m:mi></m:msub><m:msubsup><m:mi>z</m:mi><m:mi>i</m:mi><m:mn>2</m:mn></m:msubsup></m:mrow></m:math>:</para>
        <equation id="id146602">
          <m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mn>2</m:mn>
                    </m:mfrac>
                    <m:msup>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>X</m:mi>
                        <m:mi>θ</m:mi>
                        <m:mo>-</m:mo>
                        <m:mover accent="true">
                          <m:mi>y</m:mi>
                          <m:mo>→</m:mo>
                        </m:mover>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>X</m:mi>
                      <m:mi>θ</m:mi>
                      <m:mo>-</m:mo>
                      <m:mover accent="true">
                        <m:mi>y</m:mi>
                        <m:mo>→</m:mo>
                      </m:mover>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mn>2</m:mn>
                    </m:mfrac>
                    <m:munderover>
                      <m:mo>∑</m:mo>
                      <m:mrow>
                        <m:mi>i</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                      <m:mi>m</m:mi>
                    </m:munderover>
                    <m:msup>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msub>
                          <m:mi>h</m:mi>
                          <m:mi>θ</m:mi>
                        </m:msub>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:msup>
                            <m:mi>x</m:mi>
                            <m:mrow>
                              <m:mo>(</m:mo>
                              <m:mi>i</m:mi>
                              <m:mo>)</m:mo>
                            </m:mrow>
                          </m:msup>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mo>-</m:mo>
                        <m:msup>
                          <m:mi>y</m:mi>
                          <m:mrow>
                            <m:mo>(</m:mo>
                            <m:mi>i</m:mi>
                            <m:mo>)</m:mo>
                          </m:mrow>
                        </m:msup>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mi>J</m:mi>
                    <m:mo>(</m:mo>
                    <m:mi>θ</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id146772">Finally, to minimize <m:math overflow="scroll"><m:mi>J</m:mi></m:math>, let's find its derivatives with respect
to <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>.
Combining the second and third equation in <link target-id="uid16"/>, we find that</para><equation id="uid19">
          <m:math overflow="scroll" mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>∇</m:mi>
                <m:msup>
                  <m:mi>A</m:mi>
                  <m:mi>T</m:mi>
                </m:msup>
              </m:msub>
              <m:mi> tr </m:mi>
              <m:mi>A</m:mi>
              <m:mi>B</m:mi>
              <m:msup>
                <m:mi>A</m:mi>
                <m:mi>T</m:mi>
              </m:msup>
              <m:mi>C</m:mi>
              <m:mo>=</m:mo>
              <m:msup>
                <m:mi>B</m:mi>
                <m:mi>T</m:mi>
              </m:msup>
              <m:msup>
                <m:mi>A</m:mi>
                <m:mi>T</m:mi>
              </m:msup>
              <m:msup>
                <m:mi>C</m:mi>
                <m:mi>T</m:mi>
              </m:msup>
              <m:mo>+</m:mo>
              <m:mi>B</m:mi>
              <m:msup>
                <m:mi>A</m:mi>
                <m:mi>T</m:mi>
              </m:msup>
              <m:mi>C</m:mi>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id146883">Hence,</para>
        <equation id="id146888">
          <m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:msub>
                      <m:mi>∇</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mi>J</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>θ</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:msub>
                      <m:mi>∇</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mn>2</m:mn>
                    </m:mfrac>
                    <m:msup>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>X</m:mi>
                        <m:mi>θ</m:mi>
                        <m:mo>-</m:mo>
                        <m:mover accent="true">
                          <m:mi>y</m:mi>
                          <m:mo>→</m:mo>
                        </m:mover>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>X</m:mi>
                      <m:mi>θ</m:mi>
                      <m:mo>-</m:mo>
                      <m:mover accent="true">
                        <m:mi>y</m:mi>
                        <m:mo>→</m:mo>
                      </m:mover>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mn>2</m:mn>
                    </m:mfrac>
                    <m:msub>
                      <m:mi>∇</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mspace width="0.166667em"/>
                    <m:mfenced separators="" open="(" close=")">
                      <m:msup>
                        <m:mi>θ</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:msup>
                        <m:mi>X</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mi>X</m:mi>
                      <m:mi>θ</m:mi>
                      <m:mo>-</m:mo>
                      <m:msup>
                        <m:mi>θ</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:msup>
                        <m:mi>X</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mover accent="true">
                        <m:mi>y</m:mi>
                        <m:mo>→</m:mo>
                      </m:mover>
                      <m:mo>-</m:mo>
                      <m:msup>
                        <m:mrow>
                          <m:mover accent="true">
                            <m:mi>y</m:mi>
                            <m:mo>→</m:mo>
                          </m:mover>
                        </m:mrow>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mi>X</m:mi>
                      <m:mi>θ</m:mi>
                      <m:mo>+</m:mo>
                      <m:msup>
                        <m:mrow>
                          <m:mover accent="true">
                            <m:mi>y</m:mi>
                            <m:mo>→</m:mo>
                          </m:mover>
                        </m:mrow>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mover accent="true">
                        <m:mi>y</m:mi>
                        <m:mo>→</m:mo>
                      </m:mover>
                    </m:mfenced>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mn>2</m:mn>
                    </m:mfrac>
                    <m:msub>
                      <m:mi>∇</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mspace width="0.166667em"/>
                    <m:mi> tr </m:mi>
                    <m:mfenced separators="" open="(" close=")">
                      <m:msup>
                        <m:mi>θ</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:msup>
                        <m:mi>X</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mi>X</m:mi>
                      <m:mi>θ</m:mi>
                      <m:mo>-</m:mo>
                      <m:msup>
                        <m:mi>θ</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:msup>
                        <m:mi>X</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mover accent="true">
                        <m:mi>y</m:mi>
                        <m:mo>→</m:mo>
                      </m:mover>
                      <m:mo>-</m:mo>
                      <m:msup>
                        <m:mrow>
                          <m:mover accent="true">
                            <m:mi>y</m:mi>
                            <m:mo>→</m:mo>
                          </m:mover>
                        </m:mrow>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mi>X</m:mi>
                      <m:mi>θ</m:mi>
                      <m:mo>+</m:mo>
                      <m:msup>
                        <m:mrow>
                          <m:mover accent="true">
                            <m:mi>y</m:mi>
                            <m:mo>→</m:mo>
                          </m:mover>
                        </m:mrow>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mover accent="true">
                        <m:mi>y</m:mi>
                        <m:mo>→</m:mo>
                      </m:mover>
                    </m:mfenced>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mn>2</m:mn>
                    </m:mfrac>
                    <m:msub>
                      <m:mi>∇</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mspace width="0.166667em"/>
                    <m:mfenced separators="" open="(" close=")">
                      <m:mi> tr </m:mi>
                      <m:mspace width="0.166667em"/>
                      <m:msup>
                        <m:mi>θ</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:msup>
                        <m:mi>X</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mi>X</m:mi>
                      <m:mi>θ</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>2</m:mn>
                      <m:mi> tr </m:mi>
                      <m:mspace width="0.166667em"/>
                      <m:msup>
                        <m:mrow>
                          <m:mover accent="true">
                            <m:mi>y</m:mi>
                            <m:mo>→</m:mo>
                          </m:mover>
                        </m:mrow>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mi>X</m:mi>
                      <m:mi>θ</m:mi>
                    </m:mfenced>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mn>2</m:mn>
                    </m:mfrac>
                    <m:mfenced separators="" open="(" close=")">
                      <m:msup>
                        <m:mi>X</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mi>X</m:mi>
                      <m:mi>θ</m:mi>
                      <m:mo>+</m:mo>
                      <m:msup>
                        <m:mi>X</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mi>X</m:mi>
                      <m:mi>θ</m:mi>
                      <m:mo>-</m:mo>
                      <m:mn>2</m:mn>
                      <m:msup>
                        <m:mi>X</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mover accent="true">
                        <m:mi>y</m:mi>
                        <m:mo>→</m:mo>
                      </m:mover>
                    </m:mfenced>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:msup>
                      <m:mi>X</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mi>X</m:mi>
                    <m:mi>θ</m:mi>
                    <m:mo>-</m:mo>
                    <m:msup>
                      <m:mi>X</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mover accent="true">
                      <m:mi>y</m:mi>
                      <m:mo>→</m:mo>
                    </m:mover>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id147453">In the third step, we used the fact that the trace of a real number
is just the real number; the fourth step used the fact that <m:math overflow="scroll"><m:mrow><m:mi> tr </m:mi><m:mi>A</m:mi><m:mo>=</m:mo><m:mi> tr </m:mi><m:msup><m:mi>A</m:mi><m:mi>T</m:mi></m:msup></m:mrow></m:math>, and
the fifth step used Equation <link target-id="uid19"/> with <m:math overflow="scroll"><m:mrow><m:msup><m:mi>A</m:mi><m:mi>T</m:mi></m:msup><m:mo>=</m:mo><m:mi>θ</m:mi></m:mrow></m:math>, <m:math overflow="scroll"><m:mrow><m:mi>B</m:mi><m:mo>=</m:mo><m:msup><m:mi>B</m:mi><m:mi>T</m:mi></m:msup><m:mo>=</m:mo><m:msup><m:mi>X</m:mi><m:mi>T</m:mi></m:msup><m:mi>X</m:mi></m:mrow></m:math>,
and <m:math overflow="scroll"><m:mrow><m:mi>C</m:mi><m:mo>=</m:mo><m:mi>I</m:mi></m:mrow></m:math>, and Equation <link target-id="uid16"/>. To minimize <m:math overflow="scroll"><m:mi>J</m:mi></m:math>, we set its
derivatives to zero, and obtain the <emphasis effect="bold">normal equations</emphasis>:</para>
        <equation id="id147574">
          <m:math overflow="scroll" mode="display">
            <m:mrow>
              <m:msup>
                <m:mi>X</m:mi>
                <m:mi>T</m:mi>
              </m:msup>
              <m:mi>X</m:mi>
              <m:mi>θ</m:mi>
              <m:mo>=</m:mo>
              <m:msup>
                <m:mi>X</m:mi>
                <m:mi>T</m:mi>
              </m:msup>
              <m:mover accent="true">
                <m:mi>y</m:mi>
                <m:mo>→</m:mo>
              </m:mover>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id147614">Thus, the value of <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> that minimizes <m:math overflow="scroll"><m:mrow><m:mi>J</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math> is given in closed
form by the equation</para>
        <equation id="id147647">
          <m:math overflow="scroll" mode="display">
            <m:mrow>
              <m:mi>θ</m:mi>
              <m:mo>=</m:mo>
              <m:msup>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:msup>
                    <m:mi>X</m:mi>
                    <m:mi>T</m:mi>
                  </m:msup>
                  <m:mi>X</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
                <m:mrow>
                  <m:mo>-</m:mo>
                  <m:mn>1</m:mn>
                </m:mrow>
              </m:msup>
              <m:msup>
                <m:mi>X</m:mi>
                <m:mi>T</m:mi>
              </m:msup>
              <m:mover accent="true">
                <m:mi>y</m:mi>
                <m:mo>→</m:mo>
              </m:mover>
              <m:mo>.</m:mo>
            </m:mrow>
          </m:math>
        </equation>
      </section>
    </section>
    <section id="cid4">
      <title>Probabilistic interpretation</title>
      <para id="id147712">When faced with a regression problem, why might linear regression, and specifically
why might the least-squares cost function <m:math overflow="scroll"><m:mi>J</m:mi></m:math>, be a reasonable choice? In this section,
we will give a set of probabilistic assumptions, under which least-squares regression
is derived as a very natural algorithm.</para>
      <para id="id147728">Let us assume that the target variables and the inputs are related via the equation</para>
      <equation id="id147732">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msup>
              <m:mi>y</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>i</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:mo>=</m:mo>
            <m:msup>
              <m:mi>θ</m:mi>
              <m:mi>T</m:mi>
            </m:msup>
            <m:msup>
              <m:mi>x</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>i</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:mo>+</m:mo>
            <m:msup>
              <m:mi>ϵ</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>i</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id147793">where <m:math overflow="scroll"><m:msup><m:mi>ϵ</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> is an error term that captures either
unmodeled effects (such as if there are some features very pertinent
to predicting housing price, but that we'd left out of the regression),
or random noise. Let us further assume that the <m:math overflow="scroll"><m:msup><m:mi>ϵ</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> are
distributed IID (independently and identically distributed) according
to a Gaussian distribution (also called a Normal distribution)
with mean zero and some variance <m:math overflow="scroll"><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup></m:math>.
We can write this assumption as “<m:math overflow="scroll"><m:mrow><m:msup><m:mi>ϵ</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>∼</m:mo><m:mi mathvariant="script">N</m:mi><m:mrow><m:mo>(</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup><m:mo>)</m:mo></m:mrow></m:mrow></m:math>.”
I.e., the density of
<m:math overflow="scroll"><m:msup><m:mi>ϵ</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> is given by</para>
      <equation id="id147922">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msup>
                <m:mi>ϵ</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>i</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:msup>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mfrac>
              <m:mn>1</m:mn>
              <m:mrow>
                <m:msqrt>
                  <m:mrow>
                    <m:mn>2</m:mn>
                    <m:mi>π</m:mi>
                  </m:mrow>
                </m:msqrt>
                <m:mi>σ</m:mi>
              </m:mrow>
            </m:mfrac>
            <m:mo form="prefix">exp</m:mo>
            <m:mfenced separators="" open="(" close=")">
              <m:mo>-</m:mo>
              <m:mfrac>
                <m:msup>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msup>
                      <m:mi>ϵ</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>i</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:msup>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mn>2</m:mn>
                </m:msup>
                <m:mrow>
                  <m:mn>2</m:mn>
                  <m:msup>
                    <m:mi>σ</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                </m:mrow>
              </m:mfrac>
            </m:mfenced>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id148021">This implies that</para>
      <equation id="id148027">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msup>
                <m:mi>y</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>i</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:msup>
              <m:mo>|</m:mo>
              <m:msup>
                <m:mi>x</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>i</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:msup>
              <m:mo>;</m:mo>
              <m:mi>θ</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mfrac>
              <m:mn>1</m:mn>
              <m:mrow>
                <m:msqrt>
                  <m:mrow>
                    <m:mn>2</m:mn>
                    <m:mi>π</m:mi>
                  </m:mrow>
                </m:msqrt>
                <m:mi>σ</m:mi>
              </m:mrow>
            </m:mfrac>
            <m:mo form="prefix">exp</m:mo>
            <m:mfenced separators="" open="(" close=")">
              <m:mo>-</m:mo>
              <m:mfrac>
                <m:msup>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msup>
                      <m:mi>y</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>i</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:msup>
                    <m:mo>-</m:mo>
                    <m:msup>
                      <m:mi>θ</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:msup>
                      <m:mi>x</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>i</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:msup>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mn>2</m:mn>
                </m:msup>
                <m:mrow>
                  <m:mn>2</m:mn>
                  <m:msup>
                    <m:mi>σ</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                </m:mrow>
              </m:mfrac>
            </m:mfenced>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id148168">The notation “<m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>|</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>” indicates that this is the distribution
of <m:math overflow="scroll"><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> given <m:math overflow="scroll"><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> and parameterized by <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>. Note that we should
not condition on <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> (“<m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>|</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>,</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>”), since <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> is not
a random variable. We can also write the distribution of <m:math overflow="scroll"><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> as
as <m:math overflow="scroll"><m:mrow><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>∣</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>∼</m:mo><m:mi mathvariant="script">N</m:mi><m:mrow><m:mo>(</m:mo><m:msup><m:mi>θ</m:mi><m:mi>T</m:mi></m:msup><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>,</m:mo><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup><m:mo>)</m:mo></m:mrow></m:mrow></m:math>.</para>
      <para id="id148435">Given <m:math overflow="scroll"><m:mi>X</m:mi></m:math> (the design matrix, which contains all the <m:math overflow="scroll"><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>'s) and <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>,
what is the distribution of the <m:math overflow="scroll"><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>'s? The probability of the data is
given by <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mover accent="true"><m:mi>y</m:mi><m:mo>→</m:mo></m:mover><m:mo>|</m:mo><m:mi>X</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>. This quantity is typically viewed a function
of <m:math overflow="scroll"><m:mover accent="true"><m:mi>y</m:mi><m:mo>→</m:mo></m:mover></m:math> (and perhaps <m:math overflow="scroll"><m:mi>X</m:mi></m:math>), for a fixed value of <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>. When we wish
to explicitly view this as a function of <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>, we will instead call it
the <emphasis effect="bold">likelihood</emphasis> function:</para>
      <equation id="id148578">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>L</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>θ</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>L</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>θ</m:mi>
              <m:mo>;</m:mo>
              <m:mi>X</m:mi>
              <m:mo>,</m:mo>
              <m:mover accent="true">
                <m:mi>y</m:mi>
                <m:mo>→</m:mo>
              </m:mover>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mover accent="true">
                <m:mi>y</m:mi>
                <m:mo>→</m:mo>
              </m:mover>
              <m:mo>|</m:mo>
              <m:mi>X</m:mi>
              <m:mo>;</m:mo>
              <m:mi>θ</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id148654">Note that by the independence assumption on the <m:math overflow="scroll"><m:msup><m:mi>ϵ</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>'s (and hence also the <m:math overflow="scroll"><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>'s
given the <m:math overflow="scroll"><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>'s), this can also be written</para>
      <equation id="id148720">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>L</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:munderover>
                    <m:mo>∏</m:mo>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>m</m:mi>
                  </m:munderover>
                  <m:mi>p</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msup>
                      <m:mi>y</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>i</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:msup>
                    <m:mo>∣</m:mo>
                    <m:msup>
                      <m:mi>x</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>i</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:msup>
                    <m:mo>;</m:mo>
                    <m:mi>θ</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:munderover>
                    <m:mo>∏</m:mo>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>m</m:mi>
                  </m:munderover>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:mrow>
                      <m:msqrt>
                        <m:mrow>
                          <m:mn>2</m:mn>
                          <m:mi>π</m:mi>
                        </m:mrow>
                      </m:msqrt>
                      <m:mi>σ</m:mi>
                    </m:mrow>
                  </m:mfrac>
                  <m:mo form="prefix">exp</m:mo>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mo>-</m:mo>
                    <m:mfrac>
                      <m:msup>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:msup>
                            <m:mi>y</m:mi>
                            <m:mrow>
                              <m:mo>(</m:mo>
                              <m:mi>i</m:mi>
                              <m:mo>)</m:mo>
                            </m:mrow>
                          </m:msup>
                          <m:mo>-</m:mo>
                          <m:msup>
                            <m:mi>θ</m:mi>
                            <m:mi>T</m:mi>
                          </m:msup>
                          <m:msup>
                            <m:mi>x</m:mi>
                            <m:mrow>
                              <m:mo>(</m:mo>
                              <m:mi>i</m:mi>
                              <m:mo>)</m:mo>
                            </m:mrow>
                          </m:msup>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mn>2</m:mn>
                      </m:msup>
                      <m:mrow>
                        <m:mn>2</m:mn>
                        <m:msup>
                          <m:mi>σ</m:mi>
                          <m:mn>2</m:mn>
                        </m:msup>
                      </m:mrow>
                    </m:mfrac>
                  </m:mfenced>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id148925">Now, given this probabilistic model relating the <m:math overflow="scroll"><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>'s and the <m:math overflow="scroll"><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>'s, what is
a reasonable way of choosing our best guess of the parameters <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>? The
principal of <emphasis effect="bold">maximum likelihood</emphasis> says that we should should choose
<m:math overflow="scroll"><m:mi>θ</m:mi></m:math> so as to make the data as high probability as possible. I.e., we should
choose <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> to maximize <m:math overflow="scroll"><m:mrow><m:mi>L</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>.</para>
      <para id="id149019">Instead of maximizing <m:math overflow="scroll"><m:mrow><m:mi>L</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>, we can also maximize any strictly
increasing function of <m:math overflow="scroll"><m:mrow><m:mi>L</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>. In particular, the derivations
will be a bit simpler if we instead maximize the <emphasis effect="bold">log likelihood</emphasis><m:math overflow="scroll"><m:mrow><m:mi>ℓ</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>:</para>
      <equation id="id149078">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>ℓ</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo form="prefix">log</m:mo>
                  <m:mi>L</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo form="prefix">log</m:mo>
                  <m:munderover>
                    <m:mo>∏</m:mo>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>m</m:mi>
                  </m:munderover>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:mrow>
                      <m:msqrt>
                        <m:mrow>
                          <m:mn>2</m:mn>
                          <m:mi>π</m:mi>
                        </m:mrow>
                      </m:msqrt>
                      <m:mi>σ</m:mi>
                    </m:mrow>
                  </m:mfrac>
                  <m:mo form="prefix">exp</m:mo>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mo>-</m:mo>
                    <m:mfrac>
                      <m:msup>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:msup>
                            <m:mi>y</m:mi>
                            <m:mrow>
                              <m:mo>(</m:mo>
                              <m:mi>i</m:mi>
                              <m:mo>)</m:mo>
                            </m:mrow>
                          </m:msup>
                          <m:mo>-</m:mo>
                          <m:msup>
                            <m:mi>θ</m:mi>
                            <m:mi>T</m:mi>
                          </m:msup>
                          <m:msup>
                            <m:mi>x</m:mi>
                            <m:mrow>
                              <m:mo>(</m:mo>
                              <m:mi>i</m:mi>
                              <m:mo>)</m:mo>
                            </m:mrow>
                          </m:msup>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mn>2</m:mn>
                      </m:msup>
                      <m:mrow>
                        <m:mn>2</m:mn>
                        <m:msup>
                          <m:mi>σ</m:mi>
                          <m:mn>2</m:mn>
                        </m:msup>
                      </m:mrow>
                    </m:mfrac>
                  </m:mfenced>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:munderover>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>m</m:mi>
                  </m:munderover>
                  <m:mo form="prefix">log</m:mo>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:mrow>
                      <m:msqrt>
                        <m:mrow>
                          <m:mn>2</m:mn>
                          <m:mi>π</m:mi>
                        </m:mrow>
                      </m:msqrt>
                      <m:mi>σ</m:mi>
                    </m:mrow>
                  </m:mfrac>
                  <m:mo form="prefix">exp</m:mo>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mo>-</m:mo>
                    <m:mfrac>
                      <m:msup>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:msup>
                            <m:mi>y</m:mi>
                            <m:mrow>
                              <m:mo>(</m:mo>
                              <m:mi>i</m:mi>
                              <m:mo>)</m:mo>
                            </m:mrow>
                          </m:msup>
                          <m:mo>-</m:mo>
                          <m:msup>
                            <m:mi>θ</m:mi>
                            <m:mi>T</m:mi>
                          </m:msup>
                          <m:msup>
                            <m:mi>x</m:mi>
                            <m:mrow>
                              <m:mo>(</m:mo>
                              <m:mi>i</m:mi>
                              <m:mo>)</m:mo>
                            </m:mrow>
                          </m:msup>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mn>2</m:mn>
                      </m:msup>
                      <m:mrow>
                        <m:mn>2</m:mn>
                        <m:msup>
                          <m:mi>σ</m:mi>
                          <m:mn>2</m:mn>
                        </m:msup>
                      </m:mrow>
                    </m:mfrac>
                  </m:mfenced>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mi>m</m:mi>
                  <m:mo form="prefix">log</m:mo>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:mrow>
                      <m:msqrt>
                        <m:mrow>
                          <m:mn>2</m:mn>
                          <m:mi>π</m:mi>
                        </m:mrow>
                      </m:msqrt>
                      <m:mi>σ</m:mi>
                    </m:mrow>
                  </m:mfrac>
                  <m:mo>-</m:mo>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:msup>
                      <m:mi>σ</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mfrac>
                  <m:mo>·</m:mo>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:mn>2</m:mn>
                  </m:mfrac>
                  <m:munderover>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>m</m:mi>
                  </m:munderover>
                  <m:msup>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msup>
                        <m:mi>y</m:mi>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>i</m:mi>
                          <m:mo>)</m:mo>
                        </m:mrow>
                      </m:msup>
                      <m:mo>-</m:mo>
                      <m:msup>
                        <m:mi>θ</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:msup>
                        <m:mi>x</m:mi>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>i</m:mi>
                          <m:mo>)</m:mo>
                        </m:mrow>
                      </m:msup>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id149478">Hence, maximizing <m:math overflow="scroll"><m:mrow><m:mi>ℓ</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math> gives the same answer as minimizing</para>
      <equation id="id149502">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mfrac>
              <m:mn>1</m:mn>
              <m:mn>2</m:mn>
            </m:mfrac>
            <m:munderover>
              <m:mo>∑</m:mo>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mo>=</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
              <m:mi>m</m:mi>
            </m:munderover>
            <m:msup>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msup>
                  <m:mi>y</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>i</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:msup>
                <m:mo>-</m:mo>
                <m:msup>
                  <m:mi>θ</m:mi>
                  <m:mi>T</m:mi>
                </m:msup>
                <m:msup>
                  <m:mi>x</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>i</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:msup>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mn>2</m:mn>
            </m:msup>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id149582">which we recognize to be <m:math overflow="scroll"><m:mrow><m:mi>J</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>, our original least-squares cost function.</para>
      <para id="id149605">To summarize: Under the previous probabilistic assumptions on the data,
least-squares regression corresponds to finding the maximum likelihood
estimate of <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>. This is thus one set of assumptions under which
least-squares regression can be justified as a very natural method that's
just doing maximum likelihood estimation. (Note however that the
probabilistic assumptions are by no means <emphasis effect="italics">necessary</emphasis> for least-squares
to be a perfectly good and rational procedure, and there may—and indeed
there are—other natural assumptions that can also be used to justify it.)</para>
      <para id="id149629">Note also that, in our previous discussion, our final choice of <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> did
not depend on what was <m:math overflow="scroll"><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup></m:math>, and indeed we'd have arrived at the
same result even if <m:math overflow="scroll"><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup></m:math> were unknown.
We will use this fact again later, when we talk about the
exponential family and generalized linear models.</para>
    </section>
    <section id="cid5">
      <title>Locally weighted linear regression</title>
      <para id="id149682">Consider the problem of predicting <m:math overflow="scroll"><m:mi>y</m:mi></m:math> from <m:math overflow="scroll"><m:mrow><m:mi>x</m:mi><m:mo>∈</m:mo><m:mi mathvariant="double-struck">R</m:mi></m:mrow></m:math>. The leftmost figure
below shows the result of fitting a <m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>=</m:mo><m:msub><m:mi>θ</m:mi><m:mn>0</m:mn></m:msub><m:mo>+</m:mo><m:msub><m:mi>θ</m:mi><m:mn>1</m:mn></m:msub><m:mi>x</m:mi></m:mrow></m:math> to a dataset.
We see that the data doesn't really lie on straight line, and so the fit is
not very good.</para>
      <para id="id149744">
        <figure id="id149745"><media id="id149745_media" alt="one data set with a best fit line">
            <image mime-type="image/png" src="../../media/regressionPoly1-6459.png" id="id149745_onlineimage" width="485"><!-- NOTE: attribute width changes image size online (pixels). original width is 485. --></image>
            <image mime-type="application/postscript" for="pdf" print-width="3.5in" src="../../media/regressionPoly1-f596.eps" id="id149745_printimage"/>
          </media>
        </figure><figure id="id149751"><media id="id149751_media" alt="the same dataset with a curved line fit">
            <image mime-type="image/png" src="../../media/regressionPoly2-ed13.png" id="id149751_onlineimage" width="485"><!-- NOTE: attribute width changes image size online (pixels). original width is 485. --></image>
            <image mime-type="application/postscript" for="pdf" print-width="3.5in" src="../../media/regressionPoly2-2fa1.eps" id="id149751_printimage"/>
          </media>
        </figure><figure id="id149758"><media id="id149758_media" alt="the same data set where the line curves to meet each point">
            <image mime-type="image/png" src="../../media/regressionPoly5-f820.png" id="id149758_onlineimage" width="485"><!-- NOTE: attribute width changes image size online (pixels). original width is 485. --></image>
            <image mime-type="application/postscript" for="pdf" print-width="3.5in" src="../../media/regressionPoly5-773e.eps" id="id149758_printimage"/>
          </media>
        </figure></para>
      <para id="id149765">Instead, if we had added an extra feature <m:math overflow="scroll"><m:msup><m:mi>x</m:mi><m:mn>2</m:mn></m:msup></m:math>, and fit
<m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>=</m:mo><m:msub><m:mi>θ</m:mi><m:mn>0</m:mn></m:msub><m:mo>+</m:mo><m:msub><m:mi>θ</m:mi><m:mn>1</m:mn></m:msub><m:mi>x</m:mi><m:mo>+</m:mo><m:msub><m:mi>θ</m:mi><m:mn>2</m:mn></m:msub><m:msup><m:mi>x</m:mi><m:mn>2</m:mn></m:msup></m:mrow></m:math>, then we obtain a slightly better
fit to the data. (See middle figure) Naively, it might seem that the more
features we add, the better. However, there is also a danger in adding too
many features: The rightmost figure is the result of fitting a 5-th order polynomial
<m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>=</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow><m:mn>5</m:mn></m:msubsup><m:msub><m:mi>θ</m:mi><m:mi>j</m:mi></m:msub><m:msup><m:mi>x</m:mi><m:mi>j</m:mi></m:msup></m:mrow></m:math>. We see that even though the fitted curve
passes through the data perfectly, we would not expect this to be a very good
predictor of, say, housing prices (<m:math overflow="scroll"><m:mi>y</m:mi></m:math>) for different living areas (<m:math overflow="scroll"><m:mi>x</m:mi></m:math>).
Without formally defining what these terms mean,
we'll say the figure on the left shows an instance of
<emphasis effect="bold">underfitting</emphasis>—in which the data clearly shows structure not captured
by the model—and the figure on the right is an example of <emphasis effect="bold">overfitting</emphasis>.
(Later in this class, when we talk about learning theory we'll formalize
some of these notions, and also define more carefully just what it means for
a hypothesis to be good or bad.)</para>
      <para id="id149911">As discussed previously, and as shown in the example above, the choice
of features is important to ensuring good performance of a learning algorithm.
(When we talk about model selection, we'll also see algorithms for automatically
choosing a good set of features.) In this section, let us talk
briefly talk about the locally weighted linear regression (LWR) algorithm which,
assuming there is sufficient training data, makes the choice of features
less critical. This treatment will be brief, since you'll get a chance to
explore some of the properties of the LWR algorithm yourself in the homework.</para>
      <para id="id149919">In the original linear regression algorithm, to make a prediction at a query
point <m:math overflow="scroll"><m:mi>x</m:mi></m:math> (i.e., to evaluate <m:math overflow="scroll"><m:mrow><m:mi>h</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:math>), we would:</para>
      <list id="id149949" display="block" list-type="enumerated">
        <item id="uid20">Fit <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> to minimize <m:math overflow="scroll"><m:mrow><m:msub><m:mo>∑</m:mo><m:mi>i</m:mi></m:msub><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>-</m:mo><m:msup><m:mi>θ</m:mi><m:mi>T</m:mi></m:msup><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow><m:mn>2</m:mn></m:msup></m:mrow></m:math>.
</item>
        <item id="uid21">Output <m:math overflow="scroll"><m:mrow><m:msup><m:mi>θ</m:mi><m:mi>T</m:mi></m:msup><m:mi>x</m:mi></m:mrow></m:math>.
</item>
      </list>
      <para id="id150066">In contrast, the locally weighted linear regression algorithm does the following:</para>
      <list id="id150070" display="block" list-type="enumerated">
        <item id="uid22">Fit <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> to minimize <m:math overflow="scroll"><m:mrow><m:msub><m:mo>∑</m:mo><m:mi>i</m:mi></m:msub><m:msup><m:mi>w</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>-</m:mo><m:msup><m:mi>θ</m:mi><m:mi>T</m:mi></m:msup><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow><m:mn>2</m:mn></m:msup></m:mrow></m:math>.
</item>
        <item id="uid23">Output <m:math overflow="scroll"><m:mrow><m:msup><m:mi>θ</m:mi><m:mi>T</m:mi></m:msup><m:mi>x</m:mi></m:mrow></m:math>.
</item>
      </list>
      <para id="id150199">Here, the <m:math overflow="scroll"><m:msup><m:mi>w</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>'s are non-negative valued <emphasis effect="bold">weights</emphasis>. Intuitively, if <m:math overflow="scroll"><m:msup><m:mi>w</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>
is large for a particular value of <m:math overflow="scroll"><m:mi>i</m:mi></m:math>, then in picking <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>, we'll try hard to
make <m:math overflow="scroll"><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>-</m:mo><m:msup><m:mi>θ</m:mi><m:mi>T</m:mi></m:msup><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow><m:mn>2</m:mn></m:msup></m:math> small. If <m:math overflow="scroll"><m:msup><m:mi>w</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> is small, then the
<m:math overflow="scroll"><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>-</m:mo><m:msup><m:mi>θ</m:mi><m:mi>T</m:mi></m:msup><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow><m:mn>2</m:mn></m:msup></m:math> error term will be pretty much ignored in the fit.</para>
      <para id="id150391">A fairly standard choice for the weights is<footnote id="uid24">If <m:math overflow="scroll"><m:mi>x</m:mi></m:math> is vector-valued,
this is generalized to be
<m:math overflow="scroll"><m:mrow><m:msup><m:mi>w</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>=</m:mo><m:mo form="prefix">exp</m:mo><m:mrow><m:mo>(</m:mo><m:mo>-</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>-</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mi>T</m:mi></m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>-</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>/</m:mo><m:mrow><m:mo>(</m:mo><m:mn>2</m:mn><m:msup><m:mi>τ</m:mi><m:mn>2</m:mn></m:msup><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:math>, or
<m:math overflow="scroll"><m:mrow><m:msup><m:mi>w</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>=</m:mo><m:mo form="prefix">exp</m:mo><m:mrow><m:mo>(</m:mo><m:mo>-</m:mo><m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>-</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mi>T</m:mi></m:msup><m:msup><m:mi>Σ</m:mi><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>-</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>/</m:mo><m:mn>2</m:mn><m:mo>)</m:mo></m:mrow></m:mrow></m:math>, for
an appropriate choice of <m:math overflow="scroll"><m:mi>τ</m:mi></m:math> or <m:math overflow="scroll"><m:mi>Σ</m:mi></m:math>.</footnote></para>
      <equation id="id150632">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msup>
              <m:mi>w</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>i</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msup>
            <m:mo>=</m:mo>
            <m:mo form="prefix">exp</m:mo>
            <m:mfenced separators="" open="(" close=")">
              <m:mo>-</m:mo>
              <m:mfrac>
                <m:msup>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msup>
                      <m:mi>x</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>i</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:msup>
                    <m:mo>-</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mn>2</m:mn>
                </m:msup>
                <m:mrow>
                  <m:mn>2</m:mn>
                  <m:msup>
                    <m:mi>τ</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                </m:mrow>
              </m:mfrac>
            </m:mfenced>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id150711">Note that the weights depend on the particular point <m:math overflow="scroll"><m:mi>x</m:mi></m:math> at which we're
trying to evaluate <m:math overflow="scroll"><m:mi>x</m:mi></m:math>. Moreover, if <m:math overflow="scroll"><m:mrow><m:mrow><m:mo>|</m:mo></m:mrow><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mrow><m:mo>-</m:mo><m:mi>x</m:mi><m:mo>|</m:mo></m:mrow></m:mrow></m:math> is small, then <m:math overflow="scroll"><m:msup><m:mi>w</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> is
close to 1; and if <m:math overflow="scroll"><m:mrow><m:mrow><m:mo>|</m:mo></m:mrow><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mrow><m:mo>-</m:mo><m:mi>x</m:mi><m:mo>|</m:mo></m:mrow></m:mrow></m:math> is large, then <m:math overflow="scroll"><m:msup><m:mi>w</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> is small. Hence, <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>
is chosen giving a much higher “weight” to the (errors on) training
examples close to the query point <m:math overflow="scroll"><m:mi>x</m:mi></m:math>. (Note also that while the formula
for the weights takes a form that is cosmetically similar to the
density of a Gaussian distribution, the <m:math overflow="scroll"><m:msup><m:mi>w</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>'s do not directly have
anything to do with Gaussians, and in particular the <m:math overflow="scroll"><m:msup><m:mi>w</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> are not random
variables, normally distributed or otherwise.)
The parameter <m:math overflow="scroll"><m:mi>τ</m:mi></m:math> controls how quickly the weight of a training example
falls off with distance of its <m:math overflow="scroll"><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> from the query point <m:math overflow="scroll"><m:mi>x</m:mi></m:math>; <m:math overflow="scroll"><m:mi>τ</m:mi></m:math> is called
the <emphasis effect="bold">bandwidth</emphasis> parameter, and is also something that you'll get to
experiment with in your homework.</para>
      <para id="id150950">Locally weighted linear regression is the first example we're seeing
of a <emphasis effect="bold">non-parametric</emphasis> algorithm. The (unweighted) linear regression
algorithm that we saw earlier is known as a <emphasis effect="bold">parametric</emphasis> learning
algorithm, because it has a fixed, finite number of parameters
(the <m:math overflow="scroll"><m:msub><m:mi>θ</m:mi><m:mi>i</m:mi></m:msub></m:math>'s), which are
fit to the data. Once we've fit the <m:math overflow="scroll"><m:msub><m:mi>θ</m:mi><m:mi>i</m:mi></m:msub></m:math>'s and stored them away, we no
longer need to keep the training data around to make future predictions.
In contrast, to make predictions using locally weighted linear regression,
we need to keep the entire training set around. The term “non-parametric”
(roughly) refers to the fact that the amount of stuff we need to keep
in order to represent the hypothesis <m:math overflow="scroll"><m:mi>h</m:mi></m:math>
grows linearly with the size of the training set.</para>
    </section>
    <section id="cid6">
      <title>Classification and logistic regression</title>
      <para id="id151022">Let's now talk about the classification problem. This is just like
the regression problem, except that the values <m:math overflow="scroll"><m:mi>y</m:mi></m:math> we now want to
predict take on only a small number of discrete values. For now,
we will focus on the <emphasis effect="bold">binary classification</emphasis> problem in
which <m:math overflow="scroll"><m:mi>y</m:mi></m:math> can take on only two values, 0 and 1.
(Most of what we
say here will also generalize to the multiple-class case.)
For instance, if we are trying to build a spam classifier for email,
then <m:math overflow="scroll"><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> may be some features of a piece of email, and <m:math overflow="scroll"><m:mi>y</m:mi></m:math> may
be 1 if it is a piece of spam mail, and 0 otherwise.
0 is also called the <emphasis effect="bold">negative class</emphasis>, and
1 the <emphasis effect="bold">positive class</emphasis>, and they are sometimes also denoted
by the symbols “-” and “+.” Given <m:math overflow="scroll"><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math>, the corresponding
<m:math overflow="scroll"><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> is also called the <emphasis effect="bold">label</emphasis> for the training example.</para>
    </section>
    <section id="cid7">
      <title>Logistic regression</title>
      <para id="id151149">We could approach the classification problem ignoring the fact that
<m:math overflow="scroll"><m:mi>y</m:mi></m:math> is discrete-valued, and use our old linear regression algorithm to
try to predict <m:math overflow="scroll"><m:mi>y</m:mi></m:math> given <m:math overflow="scroll"><m:mi>x</m:mi></m:math>. However, it is easy to construct examples
where this method performs very poorly.
Intuitively, it also doesn't make sense for <m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> to take
values larger than 1 or smaller than 0 when we know that <m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>∈</m:mo><m:mo>{</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>}</m:mo></m:mrow></m:math>.</para>
      <para id="id151227">To fix this, let's change the form for our hypotheses <m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>. We
will choose</para>
      <equation id="id151254">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>h</m:mi>
              <m:mi>θ</m:mi>
            </m:msub>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>x</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>g</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:msup>
                <m:mi>θ</m:mi>
                <m:mi>T</m:mi>
              </m:msup>
              <m:mi>x</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mfrac>
              <m:mn>1</m:mn>
              <m:mrow>
                <m:mn>1</m:mn>
                <m:mo>+</m:mo>
                <m:msup>
                  <m:mi>e</m:mi>
                  <m:mrow>
                    <m:mo>-</m:mo>
                    <m:msup>
                      <m:mi>θ</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mi>x</m:mi>
                  </m:mrow>
                </m:msup>
              </m:mrow>
            </m:mfrac>
            <m:mo>,</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id151330">where</para>
      <equation id="id151336">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>g</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>z</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mfrac>
              <m:mn>1</m:mn>
              <m:mrow>
                <m:mn>1</m:mn>
                <m:mo>+</m:mo>
                <m:msup>
                  <m:mi>e</m:mi>
                  <m:mrow>
                    <m:mo>-</m:mo>
                    <m:mi>z</m:mi>
                  </m:mrow>
                </m:msup>
              </m:mrow>
            </m:mfrac>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id151379">is called the <emphasis effect="bold">logistic function</emphasis> or the <emphasis effect="bold">sigmoid function</emphasis>.
Here is a plot showing <m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math>:</para>
      <figure id="uid25"><media id="uid25_media" alt="the logistic function">
          <image mime-type="image/png" src="../../media/sigmoid.png" id="uid25_onlineimage" width="485"><!-- NOTE: attribute width changes image size online (pixels). original width is 485. --></image>
          <image mime-type="application/postscript" for="pdf" print-width="3.5in" src="../../media/sigmoid.eps" id="uid25_printimage"/>
        </media>
      </figure><para id="id151421">Notice that <m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math> tends towards 1 as <m:math overflow="scroll"><m:mrow><m:mi>z</m:mi><m:mo>→</m:mo><m:mi>∞</m:mi></m:mrow></m:math>, and <m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math> tends
towards 0 as <m:math overflow="scroll"><m:mrow><m:mi>z</m:mi><m:mo>→</m:mo><m:mo>-</m:mo><m:mi>∞</m:mi></m:mrow></m:math>. Moreover, g(z), and hence also <m:math overflow="scroll"><m:mrow><m:mi>h</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:math>, is
always bounded between 0 and 1. As before, we are keeping the convention
of letting <m:math overflow="scroll"><m:mrow><m:msub><m:mi>x</m:mi><m:mn>0</m:mn></m:msub><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>, so
that <m:math overflow="scroll"><m:mrow><m:msup><m:mi>θ</m:mi><m:mi>T</m:mi></m:msup><m:mi>x</m:mi><m:mo>=</m:mo><m:msub><m:mi>θ</m:mi><m:mn>0</m:mn></m:msub><m:mo>+</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>j</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>n</m:mi></m:msubsup><m:msub><m:mi>θ</m:mi><m:mi>j</m:mi></m:msub><m:msub><m:mi>x</m:mi><m:mi>j</m:mi></m:msub></m:mrow></m:math>.</para>
      <para id="id151585">For now, let's take the choice of <m:math overflow="scroll"><m:mi>g</m:mi></m:math> as given. Other functions that smoothly
increase from 0 to 1 can also be used, but for a couple of reasons that we'll
see later (when we talk about GLMs, and when we talk about generative
learning algorithms),
the choice of the logistic function is a fairly natural one.
Before moving on, here's a useful property of the derivative of the sigmoid function,
which we write as <m:math overflow="scroll"><m:msup><m:mi>g</m:mi><m:mo>'</m:mo></m:msup></m:math>:</para>
      <equation id="id151615">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:msup>
                    <m:mi>g</m:mi>
                    <m:mo>'</m:mo>
                  </m:msup>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>z</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfrac>
                    <m:mi>d</m:mi>
                    <m:mrow>
                      <m:mi>d</m:mi>
                      <m:mi>z</m:mi>
                    </m:mrow>
                  </m:mfrac>
                  <m:mspace width="0.277778em"/>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:mrow>
                      <m:mn>1</m:mn>
                      <m:mo>+</m:mo>
                      <m:msup>
                        <m:mi>e</m:mi>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mi>z</m:mi>
                        </m:mrow>
                      </m:msup>
                    </m:mrow>
                  </m:mfrac>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:msup>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mn>1</m:mn>
                        <m:mo>+</m:mo>
                        <m:msup>
                          <m:mi>e</m:mi>
                          <m:mrow>
                            <m:mo>-</m:mo>
                            <m:mi>z</m:mi>
                          </m:mrow>
                        </m:msup>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mfrac>
                  <m:mfenced separators="" open="(" close=")">
                    <m:msup>
                      <m:mi>e</m:mi>
                      <m:mrow>
                        <m:mo>-</m:mo>
                        <m:mi>z</m:mi>
                      </m:mrow>
                    </m:msup>
                  </m:mfenced>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mn>1</m:mn>
                      <m:mo>+</m:mo>
                      <m:msup>
                        <m:mi>e</m:mi>
                        <m:mrow>
                          <m:mo>-</m:mo>
                          <m:mi>z</m:mi>
                        </m:mrow>
                      </m:msup>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mfrac>
                  <m:mo>·</m:mo>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mn>1</m:mn>
                    <m:mo>-</m:mo>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mn>1</m:mn>
                        <m:mo>+</m:mo>
                        <m:msup>
                          <m:mi>e</m:mi>
                          <m:mrow>
                            <m:mo>-</m:mo>
                            <m:mi>z</m:mi>
                          </m:mrow>
                        </m:msup>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:mfrac>
                  </m:mfenced>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mi>g</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>z</m:mi>
                  <m:mo>)</m:mo>
                  <m:mo>(</m:mo>
                  <m:mn>1</m:mn>
                  <m:mo>-</m:mo>
                  <m:mi>g</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>z</m:mi>
                  <m:mo>)</m:mo>
                  <m:mo>)</m:mo>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id151856">So, given the logistic regression model, how do we fit <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> for it? Following how
we saw least squares regression could be derived as the maximum likelihood estimator
under a set of assumptions,
let's endow our classification model with a set of probabilistic assumptions,
and then fit the parameters via maximum likelihood.</para>
      <para id="id151872">Let us assume that</para>
      <equation id="id151875">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>P</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>y</m:mi>
                  <m:mo>=</m:mo>
                  <m:mn>1</m:mn>
                  <m:mo>∣</m:mo>
                  <m:mi>x</m:mi>
                  <m:mo>;</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:msub>
                    <m:mi>h</m:mi>
                    <m:mi>θ</m:mi>
                  </m:msub>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>P</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>y</m:mi>
                  <m:mo>=</m:mo>
                  <m:mn>0</m:mn>
                  <m:mo>∣</m:mo>
                  <m:mi>x</m:mi>
                  <m:mo>;</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mn>1</m:mn>
                  <m:mo>-</m:mo>
                  <m:msub>
                    <m:mi>h</m:mi>
                    <m:mi>θ</m:mi>
                  </m:msub>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id151991">Note that this can be written more compactly as</para>
      <equation id="id151997">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>p</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>y</m:mi>
                    <m:mo>∣</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>;</m:mo>
                    <m:mi>θ</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>=</m:mo>
                  <m:msup>
                    <m:mfenced separators="" open="(" close=")">
                      <m:msub>
                        <m:mi>h</m:mi>
                        <m:mi>θ</m:mi>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>x</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:mfenced>
                    <m:mi>y</m:mi>
                  </m:msup>
                  <m:msup>
                    <m:mfenced separators="" open="(" close=")">
                      <m:mn>1</m:mn>
                      <m:mo>-</m:mo>
                      <m:msub>
                        <m:mi>h</m:mi>
                        <m:mi>θ</m:mi>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>x</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:mfenced>
                    <m:mrow>
                      <m:mn>1</m:mn>
                      <m:mo>-</m:mo>
                      <m:mi>y</m:mi>
                    </m:mrow>
                  </m:msup>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id152100">Assuming that the <m:math overflow="scroll"><m:mi>m</m:mi></m:math> training examples were generated independently, we can then
write down the likelihood of the parameters as</para>
      <equation id="id152117">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>L</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mi>p</m:mi>
                  <m:mo>(</m:mo>
                  <m:mover accent="true">
                    <m:mi>y</m:mi>
                    <m:mo>→</m:mo>
                  </m:mover>
                  <m:mo>∣</m:mo>
                  <m:mi>X</m:mi>
                  <m:mo>;</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:munderover>
                    <m:mo>∏</m:mo>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>m</m:mi>
                  </m:munderover>
                  <m:mi>p</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msup>
                      <m:mi>y</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>i</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:msup>
                    <m:mo>∣</m:mo>
                    <m:msup>
                      <m:mi>x</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>i</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:msup>
                    <m:mo>;</m:mo>
                    <m:mi>θ</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:munderover>
                    <m:mo>∏</m:mo>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>m</m:mi>
                  </m:munderover>
                  <m:msup>
                    <m:mfenced separators="" open="(" close=")">
                      <m:msub>
                        <m:mi>h</m:mi>
                        <m:mi>θ</m:mi>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msup>
                          <m:mi>x</m:mi>
                          <m:mrow>
                            <m:mo>(</m:mo>
                            <m:mi>i</m:mi>
                            <m:mo>)</m:mo>
                          </m:mrow>
                        </m:msup>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:mfenced>
                    <m:msup>
                      <m:mi>y</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>i</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:msup>
                  </m:msup>
                  <m:msup>
                    <m:mfenced separators="" open="(" close=")">
                      <m:mn>1</m:mn>
                      <m:mo>-</m:mo>
                      <m:msub>
                        <m:mi>h</m:mi>
                        <m:mi>θ</m:mi>
                      </m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msup>
                          <m:mi>x</m:mi>
                          <m:mrow>
                            <m:mo>(</m:mo>
                            <m:mi>i</m:mi>
                            <m:mo>)</m:mo>
                          </m:mrow>
                        </m:msup>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:mfenced>
                    <m:mrow>
                      <m:mn>1</m:mn>
                      <m:mo>-</m:mo>
                      <m:msup>
                        <m:mi>y</m:mi>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>i</m:mi>
                          <m:mo>)</m:mo>
                        </m:mrow>
                      </m:msup>
                    </m:mrow>
                  </m:msup>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id152373">As before, it will be easier to maximize the log likelihood:</para>
      <equation id="id152379">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>ℓ</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo form="prefix">log</m:mo>
                  <m:mi>L</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:munderover>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mi>i</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>m</m:mi>
                  </m:munderover>
                  <m:msup>
                    <m:mi>y</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>i</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:msup>
                  <m:mo form="prefix">log</m:mo>
                  <m:mi>h</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msup>
                      <m:mi>x</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>i</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:msup>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>+</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mn>1</m:mn>
                    <m:mo>-</m:mo>
                    <m:msup>
                      <m:mi>y</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>i</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:msup>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo form="prefix">log</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mn>1</m:mn>
                    <m:mo>-</m:mo>
                    <m:mi>h</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msup>
                        <m:mi>x</m:mi>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>i</m:mi>
                          <m:mo>)</m:mo>
                        </m:mrow>
                      </m:msup>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id152549">How do we maximize the likelihood? Similar to our derivation in the case
of linear regression, we can use gradient ascent. Written in vectorial
notation, our updates will therefore be given by
<m:math overflow="scroll"><m:mrow><m:mi>θ</m:mi><m:mo>:</m:mo><m:mo>=</m:mo><m:mi>θ</m:mi><m:mo>+</m:mo><m:mi>α</m:mi><m:msub><m:mi>∇</m:mi><m:mi>θ</m:mi></m:msub><m:mi>ℓ</m:mi><m:mrow><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>. (Note the
positive rather than negative sign in the update formula, since we're maximizing, rather
than minimizing, a function now.) Let's start by working with just
one training example <m:math overflow="scroll"><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>,</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:math>, and take derivatives to derive the stochastic
gradient ascent rule:</para>
      <equation id="id152615">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mfrac>
                    <m:mi>∂</m:mi>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:msub>
                        <m:mi>θ</m:mi>
                        <m:mi>j</m:mi>
                      </m:msub>
                    </m:mrow>
                  </m:mfrac>
                  <m:mi>ℓ</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>θ</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mi>y</m:mi>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mrow>
                        <m:mi>g</m:mi>
                        <m:mo>(</m:mo>
                        <m:msup>
                          <m:mi>θ</m:mi>
                          <m:mi>T</m:mi>
                        </m:msup>
                        <m:mi>x</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:mfrac>
                    <m:mo>-</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mn>1</m:mn>
                      <m:mo>-</m:mo>
                      <m:mi>y</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mrow>
                        <m:mn>1</m:mn>
                        <m:mo>-</m:mo>
                        <m:mi>g</m:mi>
                        <m:mo>(</m:mo>
                        <m:msup>
                          <m:mi>θ</m:mi>
                          <m:mi>T</m:mi>
                        </m:msup>
                        <m:mi>x</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:mfrac>
                  </m:mfenced>
                  <m:mfrac>
                    <m:mi>∂</m:mi>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:msub>
                        <m:mi>θ</m:mi>
                        <m:mi>j</m:mi>
                      </m:msub>
                    </m:mrow>
                  </m:mfrac>
                  <m:mi>g</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msup>
                      <m:mi>θ</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mi>x</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mi>y</m:mi>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mrow>
                        <m:mi>g</m:mi>
                        <m:mo>(</m:mo>
                        <m:msup>
                          <m:mi>θ</m:mi>
                          <m:mi>T</m:mi>
                        </m:msup>
                        <m:mi>x</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:mfrac>
                    <m:mo>-</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mn>1</m:mn>
                      <m:mo>-</m:mo>
                      <m:mi>y</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mrow>
                        <m:mn>1</m:mn>
                        <m:mo>-</m:mo>
                        <m:mi>g</m:mi>
                        <m:mo>(</m:mo>
                        <m:msup>
                          <m:mi>θ</m:mi>
                          <m:mi>T</m:mi>
                        </m:msup>
                        <m:mi>x</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                    </m:mfrac>
                  </m:mfenced>
                  <m:mi>g</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msup>
                      <m:mi>θ</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mi>x</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mn>1</m:mn>
                    <m:mo>-</m:mo>
                    <m:mi>g</m:mi>
                  </m:mrow>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:msup>
                      <m:mi>θ</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mi>x</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mfrac>
                    <m:mi>∂</m:mi>
                    <m:mrow>
                      <m:mi>∂</m:mi>
                      <m:msub>
                        <m:mi>θ</m:mi>
                        <m:mi>j</m:mi>
                      </m:msub>
                    </m:mrow>
                  </m:mfrac>
                  <m:msup>
                    <m:mi>θ</m:mi>
                    <m:mi>T</m:mi>
                  </m:msup>
                  <m:mi>x</m:mi>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mi>y</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mn>1</m:mn>
                      <m:mo>-</m:mo>
                      <m:mi>g</m:mi>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:msup>
                          <m:mi>θ</m:mi>
                          <m:mi>T</m:mi>
                        </m:msup>
                        <m:mi>x</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>-</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mn>1</m:mn>
                      <m:mo>-</m:mo>
                      <m:mi>y</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mi>g</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msup>
                        <m:mi>θ</m:mi>
                        <m:mi>T</m:mi>
                      </m:msup>
                      <m:mi>x</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mfenced>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mi>y</m:mi>
                    <m:mo>-</m:mo>
                    <m:msub>
                      <m:mi>h</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>x</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mfenced>
                  <m:msub>
                    <m:mi>x</m:mi>
                    <m:mi>j</m:mi>
                  </m:msub>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id153044">Above, we used the fact that <m:math overflow="scroll"><m:mrow><m:msup><m:mi>g</m:mi><m:mo>'</m:mo></m:msup><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>g</m:mi><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>-</m:mo><m:mi>g</m:mi><m:mrow><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow></m:mrow></m:math>. This therefore gives
us the stochastic gradient ascent rule</para>
      <equation id="id153105">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>θ</m:mi>
              <m:mi>j</m:mi>
            </m:msub>
            <m:mo>:</m:mo>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>θ</m:mi>
              <m:mi>j</m:mi>
            </m:msub>
            <m:mo>+</m:mo>
            <m:mi>α</m:mi>
            <m:mfenced separators="" open="(" close=")">
              <m:msup>
                <m:mi>y</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>i</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:msup>
              <m:mo>-</m:mo>
              <m:msub>
                <m:mi>h</m:mi>
                <m:mi>θ</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msup>
                  <m:mi>x</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>i</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:msup>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:mfenced>
            <m:msubsup>
              <m:mi>x</m:mi>
              <m:mi>j</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>i</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msubsup>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id153202">If we compare this to the LMS update rule, we see that it looks identical;
but this is <emphasis effect="italics">not</emphasis> the same algorithm, because <m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:mrow></m:math> is now
defined as a non-linear function of <m:math overflow="scroll"><m:mrow><m:msup><m:mi>θ</m:mi><m:mi>T</m:mi></m:msup><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:mrow></m:math>. Nonetheless, it's a little
surprising that we end up with the same update rule for a rather different
algorithm and learning problem. Is this coincidence, or is there a deeper
reason behind this? We'll answer this when get get to GLM models. (See also
the extra credit problem on Q3 of problem set 1.)</para>
    </section>
    <section id="cid8">
      <title>Digression: The perceptron learning algorithm</title>
      <para id="id153290">We now digress to talk briefly about an algorithm that's
of some historical interest, and that we will also return to later when
we talk about learning theory. Consider
modifying the logistic regression method to “force” it to output values
that are either 0 or 1 or exactly. To do so, it seems natural to change the definition
of <m:math overflow="scroll"><m:mi>g</m:mi></m:math> to be the threshold function:</para>
      <equation id="id153308">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>g</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>z</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mfenced separators="" open="{" close="">
              <m:mtable>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mn>1</m:mn>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mtext>if</m:mtext>
                      <m:mspace width="4.pt"/>
                      <m:mi>z</m:mi>
                      <m:mo>≥</m:mo>
                      <m:mn>0</m:mn>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
                <m:mtr>
                  <m:mtd columnalign="left">
                    <m:mn>0</m:mn>
                  </m:mtd>
                  <m:mtd columnalign="left">
                    <m:mrow>
                      <m:mtext>if</m:mtext>
                      <m:mspace width="4.pt"/>
                      <m:mi>z</m:mi>
                      <m:mo>&lt;</m:mo>
                      <m:mn>0</m:mn>
                    </m:mrow>
                  </m:mtd>
                </m:mtr>
              </m:mtable>
            </m:mfenced>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id153383">If we then let <m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>g</m:mi><m:mrow><m:mo>(</m:mo><m:msup><m:mi>θ</m:mi><m:mi>T</m:mi></m:msup><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> as before but using this
modified definition of <m:math overflow="scroll"><m:mi>g</m:mi></m:math>, and if we use the update rule</para>
      <equation id="id153441">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>θ</m:mi>
              <m:mi>j</m:mi>
            </m:msub>
            <m:mo>:</m:mo>
            <m:mo>=</m:mo>
            <m:msub>
              <m:mi>θ</m:mi>
              <m:mi>j</m:mi>
            </m:msub>
            <m:mo>+</m:mo>
            <m:mi>α</m:mi>
            <m:mfenced separators="" open="(" close=")">
              <m:msup>
                <m:mi>y</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>i</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:msup>
              <m:mo>-</m:mo>
              <m:msub>
                <m:mi>h</m:mi>
                <m:mi>θ</m:mi>
              </m:msub>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:msup>
                  <m:mi>x</m:mi>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mi>i</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:msup>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:mfenced>
            <m:msubsup>
              <m:mi>x</m:mi>
              <m:mi>j</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>i</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
            </m:msubsup>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id153540">then we have the <emphasis effect="bold">perceptron learning algorithm</emphasis>.</para>
      <para id="id153552">In the 1960s, this “perceptron” was argued to be a rough model for
how individual neurons in the brain work. Given how simple the algorithm
is, it will also provide a starting point for our analysis when we talk
about learning theory later in this class. Note however
that even though the perceptron may be cosmetically similar to the other
algorithms we talked about, it is actually a very different type of algorithm
than logistic regression and least squares linear regression;
in particular, it is difficult to endow the perceptron's predictions
with meaningful probabilistic interpretations, or derive the perceptron
as a maximum likelihood estimation algorithm.</para>
    </section>
    <section id="cid9">
      <title>Another algorithm for maximizing <m:math overflow="scroll"><m:mrow><m:mi>ℓ</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math></title>
      <para id="id153593">Returning to logistic regression with <m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mi>z</m:mi><m:mo>)</m:mo></m:mrow></m:math> being the sigmoid function,
let's now talk about a different algorithm for maximizing <m:math overflow="scroll"><m:mrow><m:mi>ℓ</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>.</para>
      <para id="id153630">To get us started, let's consider Newton's method for finding a zero
of a function. Specifically,
suppose we have some function <m:math overflow="scroll"><m:mrow><m:mi>f</m:mi><m:mo>:</m:mo><m:mi mathvariant="double-struck">R</m:mi><m:mo>↦</m:mo><m:mi mathvariant="double-struck">R</m:mi></m:mrow></m:math>, and we wish to
find a value of <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> so that <m:math overflow="scroll"><m:mrow><m:mi>f</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>.
Here, <m:math overflow="scroll"><m:mrow><m:mi>θ</m:mi><m:mo>∈</m:mo><m:mi mathvariant="double-struck">R</m:mi></m:mrow></m:math> is a real number. Newton's method performs the following
update:</para>
      <equation id="id153704">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>θ</m:mi>
            <m:mo>:</m:mo>
            <m:mo>=</m:mo>
            <m:mi>θ</m:mi>
            <m:mo>-</m:mo>
            <m:mfrac>
              <m:mrow>
                <m:mi>f</m:mi>
                <m:mo>(</m:mo>
                <m:mi>θ</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mrow>
                <m:msup>
                  <m:mi>f</m:mi>
                  <m:mo>'</m:mo>
                </m:msup>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mrow>
            </m:mfrac>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id153756">This method has a natural interpretation in which we can think of it as
approximating the function <m:math overflow="scroll"><m:mi>f</m:mi></m:math> via a linear function that is tangent to
<m:math overflow="scroll"><m:mi>f</m:mi></m:math> at the current guess <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>, solving for where that linear function
equals to zero, and letting the next guess for <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> be where that linear
function is zero.</para>
      <para id="id153800">Here's a picture of the Newton's method in action:</para>
      <para id="id153804">
        <figure id="id153805"><media id="id153805_media" alt="This method has a natural interpretation in which we can think of it as approximating the function f via a linear function that is tangent to f at the current guess theta">
            <image mime-type="image/png" src="../../media/newton1.png" id="id153805_onlineimage" width="488"><!-- NOTE: attribute width changes image size online (pixels). original width is 488. --></image>
            <image mime-type="application/postscript" for="pdf" print-width="3.5in" src="../../media/newton1.eps" id="id153805_printimage"/>
          </media>
        </figure><figure id="id153811"><media id="id153811_media" alt="This method has a natural interpretation in which we can think of it as approximating the function f via a linear function that is tangent to f at the current guess theta">
            <image mime-type="image/png" src="../../media/newton2.png" id="id153811_onlineimage" width="488"><!-- NOTE: attribute width changes image size online (pixels). original width is 488. --></image>
            <image mime-type="application/postscript" for="pdf" print-width="3.5in" src="../../media/newton2.eps" id="id153811_printimage"/>
          </media>
        </figure><figure id="id153817"><media id="id153817_media" alt="This method has a natural interpretation in which we can think of it as approximating the function f via a linear function that is tangent to f at the current guess theta">
            <image mime-type="image/png" src="../../media/newton3.png" id="id153817_onlineimage" width="488"><!-- NOTE: attribute width changes image size online (pixels). original width is 488. --></image>
            <image mime-type="application/postscript" for="pdf" print-width="3.5in" src="../../media/newton3.eps" id="id153817_printimage"/>
          </media>
        </figure></para>
      <para id="id153824">In the leftmost figure, we see the function <m:math overflow="scroll"><m:mi>f</m:mi></m:math> plotted along with the
line <m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>. We're trying to find <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> so that <m:math overflow="scroll"><m:mrow><m:mi>f</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>; the value
of <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> that achieves this is about 1.3.
Suppose we initialized the algorithm with <m:math overflow="scroll"><m:mrow><m:mi>θ</m:mi><m:mo>=</m:mo><m:mn>4</m:mn><m:mo>.</m:mo><m:mn>5</m:mn></m:mrow></m:math>. Newton's method
then fits a straight line tangent to <m:math overflow="scroll"><m:mi>f</m:mi></m:math> at <m:math overflow="scroll"><m:mrow><m:mi>θ</m:mi><m:mo>=</m:mo><m:mn>4</m:mn><m:mo>.</m:mo><m:mn>5</m:mn></m:mrow></m:math>, and solves for
the where that line evaluates to 0. (Middle figure.) This give us the
next guess for <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>, which is about 2.8. The rightmost figure shows the result
of running one more iteration, which the updates <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> to about 1.8.
After a few more iterations, we rapidly approach <m:math overflow="scroll"><m:mrow><m:mi>θ</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>.</m:mo><m:mn>3</m:mn></m:mrow></m:math>.</para>
      <para id="id153976">Newton's method gives a way of getting to <m:math overflow="scroll"><m:mrow><m:mi>f</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>. What if we want
to use it to maximize some function <m:math overflow="scroll"><m:mi>ℓ</m:mi></m:math>? The maxima of <m:math overflow="scroll"><m:mi>ℓ</m:mi></m:math> correspond
to points where its first derivative <m:math overflow="scroll"><m:mrow><m:msup><m:mi>ℓ</m:mi><m:mo>'</m:mo></m:msup><m:mrow><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> is zero. So, by letting
<m:math overflow="scroll"><m:mrow><m:mi>f</m:mi><m:mrow><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msup><m:mi>ℓ</m:mi><m:mo>'</m:mo></m:msup><m:mrow><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>, we can use the same algorithm to maximize <m:math overflow="scroll"><m:mi>ℓ</m:mi></m:math>,
and we obtain update rule:</para>
      <equation id="id154087">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>θ</m:mi>
            <m:mo>:</m:mo>
            <m:mo>=</m:mo>
            <m:mi>θ</m:mi>
            <m:mo>-</m:mo>
            <m:mfrac>
              <m:mrow>
                <m:msup>
                  <m:mi>ℓ</m:mi>
                  <m:mo>'</m:mo>
                </m:msup>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mrow>
              <m:mrow>
                <m:msup>
                  <m:mi>ℓ</m:mi>
                  <m:mrow>
                    <m:mo>'</m:mo>
                    <m:mo>'</m:mo>
                  </m:mrow>
                </m:msup>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mrow>
            </m:mfrac>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id154149">(Something to think about: How would this change if we wanted to
use Newton's method to minimize rather than maximize a function?)</para>
      <para id="id154156">Lastly, in our logistic regression setting, <m:math overflow="scroll"><m:mi>θ</m:mi></m:math> is vector-valued, so
we need to generalize Newton's method to this setting. The generalization of
Newton's method to this multidimensional setting (also called the
Newton-Raphson method) is given by</para>
      <equation id="id154171">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>θ</m:mi>
            <m:mo>:</m:mo>
            <m:mo>=</m:mo>
            <m:mi>θ</m:mi>
            <m:mo>-</m:mo>
            <m:msup>
              <m:mi>H</m:mi>
              <m:mrow>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
              </m:mrow>
            </m:msup>
            <m:msub>
              <m:mi>∇</m:mi>
              <m:mi>θ</m:mi>
            </m:msub>
            <m:mi>ℓ</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>θ</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id154222">Here, <m:math overflow="scroll"><m:mrow><m:msub><m:mi>∇</m:mi><m:mi>θ</m:mi></m:msub><m:mi>ℓ</m:mi><m:mrow><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> is, as usual, the vector of partial derivatives
of <m:math overflow="scroll"><m:mrow><m:mi>ℓ</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math> with respect to the <m:math overflow="scroll"><m:msub><m:mi>θ</m:mi><m:mi>i</m:mi></m:msub></m:math>'s; and <m:math overflow="scroll"><m:mi>H</m:mi></m:math> is an <m:math overflow="scroll"><m:mi>n</m:mi></m:math>-by-<m:math overflow="scroll"><m:mi>n</m:mi></m:math>
matrix (actually, <m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:math>-by-<m:math overflow="scroll"><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:math>, assuming that we include the intercept term)
called the <emphasis effect="bold">Hessian</emphasis>, whose entries are given by</para>
      <equation id="id154347">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:msub>
              <m:mi>H</m:mi>
              <m:mrow>
                <m:mi>i</m:mi>
                <m:mi>j</m:mi>
              </m:mrow>
            </m:msub>
            <m:mo>=</m:mo>
            <m:mfrac>
              <m:mrow>
                <m:msup>
                  <m:mi>∂</m:mi>
                  <m:mn>2</m:mn>
                </m:msup>
                <m:mi>ℓ</m:mi>
                <m:mrow>
                  <m:mo>(</m:mo>
                  <m:mi>θ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mrow>
              <m:mrow>
                <m:mi>∂</m:mi>
                <m:msub>
                  <m:mi>θ</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:mi>∂</m:mi>
                <m:msub>
                  <m:mi>θ</m:mi>
                  <m:mi>j</m:mi>
                </m:msub>
              </m:mrow>
            </m:mfrac>
            <m:mo>.</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id154413">Newton's method typically enjoys faster convergence than (batch) gradient
descent, and requires many fewer iterations to get very close to the
minimum. One iteration of Newton's can, however, be more expensive than one
iteration of gradient descent, since it requires finding and
inverting an <m:math overflow="scroll"><m:mi>n</m:mi></m:math>-by-<m:math overflow="scroll"><m:mi>n</m:mi></m:math> Hessian; but so long as <m:math overflow="scroll"><m:mi>n</m:mi></m:math> is not too large,
it is usually much faster overall. When Newton's method is applied to maximize the
logistic regression log likelihood function <m:math overflow="scroll"><m:mrow><m:mi>ℓ</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>, the resulting method
is also called <emphasis effect="bold">Fisher scoring</emphasis>.</para>
    </section>
    <section id="cid10">
      <title>Generalized Linear
Models<footnote id="uid26">The presentation of the
material in this section takes inspiration from Michael I. Jordan, 
<emphasis effect="italics">Learning
in graphical models</emphasis>
 (unpublished book draft), and also McCullagh and Nelder,

<emphasis effect="italics">Generalized Linear Models (2nd ed.)</emphasis>
.
</footnote></title>
      <para id="id154523">So far, we've seen a regression example, and a classification example.
In the regression example, we had <m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>∼</m:mo><m:mi mathvariant="script">N</m:mi><m:mo>(</m:mo><m:mi>μ</m:mi><m:mo>,</m:mo><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup><m:mo>)</m:mo></m:mrow></m:math>, and
in the classification one, <m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>∼</m:mo><m:mi> Bernoulli </m:mi><m:mo>(</m:mo><m:mi>Φ</m:mi><m:mo>)</m:mo></m:mrow></m:math>,
for some appropriate definitions of <m:math overflow="scroll"><m:mi>μ</m:mi></m:math> and <m:math overflow="scroll"><m:mi>Φ</m:mi></m:math>
as functions
of <m:math overflow="scroll"><m:mi>x</m:mi></m:math> and <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>. In this section, we will show that both of
these methods are special cases of a broader family of models, called
Generalized Linear Models (GLMs). We will also show how other models
in the GLM family can be derived and applied to other classification
and regression problems.</para>
    </section>
    <section id="cid11">
      <title>The exponential family</title>
      <para id="id154648">To work our way up to GLMs, we will begin by defining exponential family distributions.
We say that a class of distributions is in the exponential family if it can be written
in the form</para>
      <equation id="uid27">
        <m:math overflow="scroll" mode="display">
          <m:mrow>
            <m:mi>p</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>y</m:mi>
              <m:mo>;</m:mo>
              <m:mi>η</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>=</m:mo>
            <m:mi>b</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>y</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo form="prefix">exp</m:mo>
            <m:mo>(</m:mo>
            <m:msup>
              <m:mi>η</m:mi>
              <m:mi>T</m:mi>
            </m:msup>
            <m:mi>T</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>y</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>-</m:mo>
            <m:mi>a</m:mi>
            <m:mrow>
              <m:mo>(</m:mo>
              <m:mi>η</m:mi>
              <m:mo>)</m:mo>
            </m:mrow>
            <m:mo>)</m:mo>
          </m:mrow>
        </m:math>
      </equation>
      <para id="id154730">Here, <m:math overflow="scroll"><m:mi>η</m:mi></m:math> is called the <emphasis effect="bold">natural parameter</emphasis>
(also called the <emphasis effect="bold">canonical parameter</emphasis>) of the distribution;
<m:math overflow="scroll"><m:mrow><m:mi>T</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:math> is the <emphasis effect="bold">sufficient statistic</emphasis> (for the distributions we consider,
it will often be the case that <m:math overflow="scroll"><m:mrow><m:mi>T</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>y</m:mi></m:mrow></m:math>); and <m:math overflow="scroll"><m:mrow><m:mi>a</m:mi><m:mo>(</m:mo><m:mi>η</m:mi><m:mo>)</m:mo></m:mrow></m:math> is the <emphasis effect="bold">log partition
function</emphasis>. The quantity <m:math overflow="scroll"><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>a</m:mi><m:mo>(</m:mo><m:mi>η</m:mi><m:mo>)</m:mo></m:mrow></m:msup></m:math> essentially plays the role of a normalization
constant, that makes sure the distribution <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>;</m:mo><m:mi>η</m:mi><m:mo>)</m:mo></m:mrow></m:math> sums/integrates over <m:math overflow="scroll"><m:mi>y</m:mi></m:math> to 1.</para>
      <para id="id154878">A fixed choice of <m:math overflow="scroll"><m:mi>T</m:mi></m:math>, <m:math overflow="scroll"><m:mi>a</m:mi></m:math> and <m:math overflow="scroll"><m:mi>b</m:mi></m:math> defines a <emphasis effect="italics">family</emphasis> (or set) of distributions
that is parameterized by <m:math overflow="scroll"><m:mi>η</m:mi></m:math>; as we vary <m:math overflow="scroll"><m:mi>η</m:mi></m:math>, we then get different distributions
within this family.</para>
      <para id="id154932">We now show that the Bernoulli and the Gaussian distributions are examples of exponential family distributions.
The Bernoulli distribution with mean <m:math overflow="scroll"><m:mi>Φ</m:mi></m:math>,
written <m:math overflow="scroll"><m:mrow><m:mi> Bernoulli </m:mi><m:mo>(</m:mo><m:mi>Φ</m:mi><m:mo>)</m:mo></m:mrow></m:math>, specifies a distribution over <m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>∈</m:mo><m:mo>{</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>}</m:mo></m:mrow></m:math>, so that
<m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>;</m:mo><m:mi>Φ</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>Φ</m:mi></m:mrow></m:math>; <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>;</m:mo><m:mi>Φ</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>-</m:mo><m:mi>Φ</m:mi></m:mrow></m:math>. As we vary <m:math overflow="scroll"><m:mi>Φ</m:mi></m:math>, we obtain Bernoulli
distributions with different means. We now show that this class of Bernoulli
distributions, ones obtained by varying <m:math overflow="scroll"><m:mi>Φ</m:mi></m:math>, is in the exponential family; i.e.,
that there is a choice of <m:math overflow="scroll"><m:mi>T</m:mi></m:math>, <m:math overflow="scroll"><m:mi>a</m:mi></m:math> and <m:math overflow="scroll"><m:mi>b</m:mi></m:math> so that Equation <link target-id="uid27"/>
becomes exactly the class of Bernoulli distributions.</para>
      <para id="id155100">We write the Bernoulli distribution as:</para>
      <equation id="id155104"><m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>p</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>y</m:mi>
                  <m:mo>;</m:mo>
                  <m:mi>Φ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:msup>
                    <m:mi>Φ</m:mi>
                    <m:mi>y</m:mi>
                  </m:msup>
                  <m:msup>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mn>1</m:mn>
                      <m:mo>-</m:mo>
                      <m:mi>Φ</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mrow>
                      <m:mn>1</m:mn>
                      <m:mo>-</m:mo>
                      <m:mi>y</m:mi>
                    </m:mrow>
                  </m:msup>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo form="prefix">exp</m:mo>
                  <m:mo>(</m:mo>
                  <m:mi>y</m:mi>
                  <m:mo form="prefix">log</m:mo>
                  <m:mi>Φ</m:mi>
                  <m:mo>+</m:mo>
                  <m:mo>(</m:mo>
                  <m:mn>1</m:mn>
                  <m:mo>-</m:mo>
                  <m:mi>y</m:mi>
                  <m:mo>)</m:mo>
                  <m:mo form="prefix">log</m:mo>
                  <m:mo>(</m:mo>
                  <m:mn>1</m:mn>
                  <m:mo>-</m:mo>
                  <m:mi>Φ</m:mi>
                  <m:mo>)</m:mo>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo form="prefix">exp</m:mo>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mfenced separators="" open="(" close=")">
                      <m:mo form="prefix">log</m:mo>
                      <m:mfenced separators="" open="(" close=")">
                        <m:mfrac>
                          <m:mi>Φ</m:mi>
                          <m:mrow>
                            <m:mn>1</m:mn>
                            <m:mo>-</m:mo>
                            <m:mi>Φ</m:mi>
                          </m:mrow>
                        </m:mfrac>
                      </m:mfenced>
                    </m:mfenced>
                    <m:mi>y</m:mi>
                    <m:mo>+</m:mo>
                    <m:mo form="prefix">log</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mn>1</m:mn>
                      <m:mo>-</m:mo>
                      <m:mi>Φ</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mfenced>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation><para id="id155302">Thus, the natural parameter is given by <m:math overflow="scroll"><m:mrow><m:mi>η</m:mi><m:mo>=</m:mo><m:mo form="prefix">log</m:mo><m:mo>(</m:mo><m:mi>Φ</m:mi><m:mo>/</m:mo><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>-</m:mo><m:mi>Φ</m:mi><m:mo>)</m:mo><m:mo>)</m:mo></m:mrow></m:math>.
Interestingly, if we invert this definition for <m:math overflow="scroll"><m:mi>η</m:mi></m:math> by solving
for <m:math overflow="scroll"><m:mi>Φ</m:mi></m:math> in terms of <m:math overflow="scroll"><m:mi>η</m:mi></m:math>, we obtain <m:math overflow="scroll"><m:mrow><m:mi>Φ</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>/</m:mo><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>+</m:mo><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>η</m:mi></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:math>. This is
the familiar sigmoid function! This will come up again when we derive logistic
regression as a GLM. To complete the formulation of the Bernoulli
distribution as an exponential family
distribution, we also have</para>
      <equation id="id155410">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>T</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>y</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mi>y</m:mi>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>a</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>η</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo>-</m:mo>
                  <m:mo form="prefix">log</m:mo>
                  <m:mo>(</m:mo>
                  <m:mn>1</m:mn>
                  <m:mo>-</m:mo>
                  <m:mi>Φ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mo form="prefix">log</m:mo>
                  <m:mo>(</m:mo>
                  <m:mn>1</m:mn>
                  <m:mo>+</m:mo>
                  <m:msup>
                    <m:mi>e</m:mi>
                    <m:mi>η</m:mi>
                  </m:msup>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>b</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>y</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mn>1</m:mn>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id155536">This shows that the Bernoulli distribution can be written in the form
of Equation <link target-id="uid27"/>, using an appropriate choice of <m:math overflow="scroll"><m:mi>T</m:mi></m:math>, <m:math overflow="scroll"><m:mi>a</m:mi></m:math> and <m:math overflow="scroll"><m:mi>b</m:mi></m:math>.</para>
      <para id="id155575">Let's now move on to consider the Gaussian distribution. Recall that, when deriving
linear regression, the value of <m:math overflow="scroll"><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup></m:math> had no effect on our final choice of <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>
and <m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>. Thus, we can choose an arbitrary value for <m:math overflow="scroll"><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup></m:math> without
changing anything. To simplify the derivation below, let's
set <m:math overflow="scroll"><m:mrow><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>.<footnote id="uid28">If we leave <m:math overflow="scroll"><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup></m:math> as a variable, the Gaussian
distribution can also be shown to be in the exponential family, where <m:math overflow="scroll"><m:mrow><m:mi>η</m:mi><m:mo>∈</m:mo><m:msup><m:mrow><m:mi mathvariant="double-struck">R</m:mi></m:mrow><m:mn>2</m:mn></m:msup></m:mrow></m:math>
is now a 2-dimension vector that depends on both <m:math overflow="scroll"><m:mi>μ</m:mi></m:math> and <m:math overflow="scroll"><m:mi>σ</m:mi></m:math>. For the purposes
of GLMs, however, the <m:math overflow="scroll"><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup></m:math> parameter can also be treated by considering
a more general definition of the exponential family:
<m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>;</m:mo><m:mi>η</m:mi><m:mo>,</m:mo><m:mi>τ</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>b</m:mi><m:mrow><m:mo>(</m:mo><m:mi>a</m:mi><m:mo>,</m:mo><m:mi>τ</m:mi><m:mo>)</m:mo></m:mrow><m:mo form="prefix">exp</m:mo><m:mo>(</m:mo><m:mrow><m:mo>(</m:mo><m:msup><m:mi>η</m:mi><m:mi>T</m:mi></m:msup><m:mi>T</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow><m:mo>-</m:mo><m:mi>a</m:mi><m:mrow><m:mo>(</m:mo><m:mi>η</m:mi><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow><m:mo>/</m:mo><m:mi>c</m:mi><m:mrow><m:mo>(</m:mo><m:mi>τ</m:mi><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow></m:math>.
Here, <m:math overflow="scroll"><m:mi>τ</m:mi></m:math> is called the <emphasis effect="bold">dispersion parameter</emphasis>, and for the Gaussian,
<m:math overflow="scroll"><m:mrow><m:mi>c</m:mi><m:mrow><m:mo>(</m:mo><m:mi>τ</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup></m:mrow></m:math>; but given our simplification above, we won't need
the more general definition for the examples we will consider here.</footnote>
We then have:</para>
      <equation id="id155884">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>p</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>y</m:mi>
                  <m:mo>;</m:mo>
                  <m:mi>μ</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:msqrt>
                      <m:mrow>
                        <m:mn>2</m:mn>
                        <m:mi>π</m:mi>
                      </m:mrow>
                    </m:msqrt>
                  </m:mfrac>
                  <m:mo form="prefix">exp</m:mo>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mo>-</m:mo>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mn>2</m:mn>
                    </m:mfrac>
                    <m:msup>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>y</m:mi>
                        <m:mo>-</m:mo>
                        <m:mi>μ</m:mi>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mfenced>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mfrac>
                    <m:mn>1</m:mn>
                    <m:msqrt>
                      <m:mrow>
                        <m:mn>2</m:mn>
                        <m:mi>π</m:mi>
                      </m:mrow>
                    </m:msqrt>
                  </m:mfrac>
                  <m:mo form="prefix">exp</m:mo>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mo>-</m:mo>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mn>2</m:mn>
                    </m:mfrac>
                    <m:msup>
                      <m:mi>y</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mfenced>
                  <m:mo>·</m:mo>
                  <m:mo form="prefix">exp</m:mo>
                  <m:mfenced separators="" open="(" close=")">
                    <m:mi>μ</m:mi>
                    <m:mi>y</m:mi>
                    <m:mo>-</m:mo>
                    <m:mfrac>
                      <m:mn>1</m:mn>
                      <m:mn>2</m:mn>
                    </m:mfrac>
                    <m:msup>
                      <m:mi>μ</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                  </m:mfenced>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id156053">Thus, we see that the Gaussian is in the exponential family, with</para>
      <equation id="id156059">
        <m:math overflow="scroll" mode="display">
          <m:mtable displaystyle="true">
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mi>η</m:mi>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mi>μ</m:mi>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>T</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>y</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mi>y</m:mi>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>a</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>η</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:msup>
                    <m:mi>μ</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:mo>/</m:mo>
                  <m:mn>2</m:mn>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd/>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:msup>
                    <m:mi>η</m:mi>
                    <m:mn>2</m:mn>
                  </m:msup>
                  <m:mo>/</m:mo>
                  <m:mn>2</m:mn>
                </m:mrow>
              </m:mtd>
            </m:mtr>
            <m:mtr>
              <m:mtd columnalign="right">
                <m:mrow>
                  <m:mi>b</m:mi>
                  <m:mo>(</m:mo>
                  <m:mi>y</m:mi>
                  <m:mo>)</m:mo>
                </m:mrow>
              </m:mtd>
              <m:mtd>
                <m:mo>=</m:mo>
              </m:mtd>
              <m:mtd columnalign="left">
                <m:mrow>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mn>1</m:mn>
                    <m:mo>/</m:mo>
                    <m:msqrt>
                      <m:mrow>
                        <m:mn>2</m:mn>
                        <m:mi>π</m:mi>
                      </m:mrow>
                    </m:msqrt>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo form="prefix">exp</m:mo>
                  <m:mrow>
                    <m:mo>(</m:mo>
                    <m:mo>-</m:mo>
                    <m:msup>
                      <m:mi>y</m:mi>
                      <m:mn>2</m:mn>
                    </m:msup>
                    <m:mo>/</m:mo>
                    <m:mn>2</m:mn>
                    <m:mo>)</m:mo>
                  </m:mrow>
                  <m:mo>.</m:mo>
                </m:mrow>
              </m:mtd>
            </m:mtr>
          </m:mtable>
        </m:math>
      </equation>
      <para id="id156228">There're many other distributions that are members of the exponential family:
The multinomial (which we'll see later), the Poisson (for modelling count-data;
also see the problem set); the gamma and the exponential (for modelling continuous,
non-negative random variables, such as time-intervals); the beta and the Dirichlet
(for distributions over probabilities); and many more. In the next section, we
will describe a general “recipe” for constructing models in which <m:math overflow="scroll"><m:mi>y</m:mi></m:math>
(given <m:math overflow="scroll"><m:mi>x</m:mi></m:math> and <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>) comes from any of these distributions.</para>
    </section>
    <section id="cid12">
      <title>Constructing GLMs</title>
      <para id="id156277">Suppose you would like to build a model to estimate the number <m:math overflow="scroll"><m:mi>y</m:mi></m:math> of customers
arriving in your store (or number of page-views on your website) in any given
hour, based on certain features <m:math overflow="scroll"><m:mi>x</m:mi></m:math> such as store promotions, recent
advertising, weather, day-of-week, etc. We know that the Poisson distribution
usually gives a good model for numbers of visitors.
Knowing this, how can we come up with a model for our problem? Fortunately,
the Poisson is an exponential family distribution, so we can apply a Generalized
Linear Model (GLM).
In this section, we will we will describe a method for
constructing GLM models for problems such as these.</para>
      <para id="id156304">More generally, consider a classification or regression problem where we would
like to predict the value of some random variable <m:math overflow="scroll"><m:mi>y</m:mi></m:math> as a function of <m:math overflow="scroll"><m:mi>x</m:mi></m:math>.
To derive a GLM for this problem, we will make the following three
assumptions about the conditional distribution of <m:math overflow="scroll"><m:mi>y</m:mi></m:math> given <m:math overflow="scroll"><m:mi>x</m:mi></m:math> and
about our model:</para>
      <list id="id156344" display="block" list-type="enumerated">
        <item id="uid29"><m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>∣</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>∼</m:mo><m:mi> ExponentialFamily </m:mi><m:mo>(</m:mo><m:mi>η</m:mi><m:mo>)</m:mo></m:mrow></m:math>. I.e.,
given <m:math overflow="scroll"><m:mi>x</m:mi></m:math> and <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>, the distribution of <m:math overflow="scroll"><m:mi>y</m:mi></m:math> follows some
exponential family distribution, with parameter <m:math overflow="scroll"><m:mi>η</m:mi></m:math>.
</item>
        <item id="uid30">Given <m:math overflow="scroll"><m:mi>x</m:mi></m:math>, our goal is to predict the expected value of <m:math overflow="scroll"><m:mrow><m:mi>T</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:math> given <m:math overflow="scroll"><m:mi>x</m:mi></m:math>.
In most of our examples, we will have <m:math overflow="scroll"><m:mrow><m:mi>T</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>y</m:mi></m:mrow></m:math>, so this means we would like
the prediction <m:math overflow="scroll"><m:mrow><m:mi>h</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:math> output by our learned hypothesis <m:math overflow="scroll"><m:mi>h</m:mi></m:math> to
satisfy <m:math overflow="scroll"><m:mrow><m:mi>h</m:mi><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi mathvariant="normal">E</m:mi><m:mo>[</m:mo><m:mi>y</m:mi><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>]</m:mo></m:mrow></m:math>.
(Note that this assumption is satisfied in the choices for <m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> for
both logistic regression and linear regression.
For instance, in logistic regression,
we had <m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi>p</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>·</m:mo><m:mi>p</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>=</m:mo><m:mn>0</m:mn><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow><m:mo>+</m:mo><m:mn>1</m:mn><m:mo>·</m:mo><m:mi>p</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mi mathvariant="normal">E</m:mi><m:mrow><m:mo>[</m:mo><m:mi>y</m:mi><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>]</m:mo></m:mrow></m:mrow></m:math>.)
</item>
        <item id="uid31">The natural parameter <m:math overflow="scroll"><m:mi>η</m:mi></m:math> and the inputs <m:math overflow="scroll"><m:mi>x</m:mi></m:math> are related
linearly: <m:math overflow="scroll"><m:mrow><m:mi>η</m:mi><m:mo>=</m:mo><m:msup><m:mi>θ</m:mi><m:mi>T</m:mi></m:msup><m:mi>x</m:mi></m:mrow></m:math>.
(Or, if <m:math overflow="scroll"><m:mi>η</m:mi></m:math> is vector-valued, then <m:math overflow="scroll"><m:mrow><m:msub><m:mi>η</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:msubsup><m:mi>θ</m:mi><m:mi>i</m:mi><m:mi>T</m:mi></m:msubsup><m:mi>x</m:mi></m:mrow></m:math>.)
</item>
      </list>
      <para id="id156796">The third of these assumptions might seem the least well justified of the
above, and it might be better thought of as a “design choice” in our
recipe for designing GLMs, rather than as an assumption per se. These
three assumptions/design choices will allow us to derive a
very elegant class
of learning algorithms, namely GLMs, that have many desirable
properties such as ease of learning.
Furthermore, the resulting
models are often very effective for modelling different types of
distributions over <m:math overflow="scroll"><m:mi>y</m:mi></m:math>; for example, we will shortly show that
both logistic regression and ordinary least squares
can both be
derived as GLMs.</para>
      <section id="uid32">
        <title>Ordinary Least Squares</title>
        <para id="id156825">To show that ordinary least squares is a special case of the GLM family of
models, consider the setting where the target variable <m:math overflow="scroll"><m:mi>y</m:mi></m:math> (also called the <emphasis effect="bold">response variable</emphasis>
in GLM terminology) is continuous, and we model the conditional
distribution of <m:math overflow="scroll"><m:mi>y</m:mi></m:math> given <m:math overflow="scroll"><m:mi>x</m:mi></m:math> as as a Gaussian <m:math overflow="scroll"><m:mrow><m:mi mathvariant="script">N</m:mi><m:mo>(</m:mo><m:mi>μ</m:mi><m:mo>,</m:mo><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup><m:mo>)</m:mo></m:mrow></m:math>.
(Here, <m:math overflow="scroll"><m:mi>μ</m:mi></m:math> may depend <m:math overflow="scroll"><m:mi>x</m:mi></m:math>.) So, we let the <m:math overflow="scroll"><m:mrow><m:mi>E</m:mi><m:mi>x</m:mi><m:mi>p</m:mi><m:mi>o</m:mi><m:mi>n</m:mi><m:mi>e</m:mi><m:mi>n</m:mi><m:mi>t</m:mi><m:mi>i</m:mi><m:mi>a</m:mi><m:mi>l</m:mi><m:mi>F</m:mi><m:mi>a</m:mi><m:mi>m</m:mi><m:mi>i</m:mi><m:mi>l</m:mi><m:mi>y</m:mi><m:mo>(</m:mo><m:mi>η</m:mi><m:mo>)</m:mo></m:mrow></m:math>
distribution above be the Gaussian distribution. As we saw previously, in
the formulation of the Gaussian as an exponential family distribution, we had
<m:math overflow="scroll"><m:mrow><m:mi>μ</m:mi><m:mo>=</m:mo><m:mi>η</m:mi></m:mrow></m:math>. So, we have</para>
        <equation id="id156976">
          <m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:msub>
                      <m:mi>h</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>x</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mi>E</m:mi>
                    <m:mo>[</m:mo>
                    <m:mi>y</m:mi>
                    <m:mo>|</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>;</m:mo>
                    <m:mi>θ</m:mi>
                    <m:mo>]</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mi>μ</m:mi>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mi>η</m:mi>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:msup>
                      <m:mi>θ</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mi>x</m:mi>
                    <m:mo>.</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id157077">The first equality follows from Assumption 2, above; the second equality follows
from the fact that <m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>∼</m:mo><m:mi mathvariant="script">N</m:mi><m:mo>(</m:mo><m:mi>μ</m:mi><m:mo>,</m:mo><m:msup><m:mi>σ</m:mi><m:mn>2</m:mn></m:msup><m:mo>)</m:mo></m:mrow></m:math>, and so its expected
value is given by <m:math overflow="scroll"><m:mi>μ</m:mi></m:math>; the third equality follows from Assumption 1 (and our earlier
derivation showing that <m:math overflow="scroll"><m:mrow><m:mi>μ</m:mi><m:mo>=</m:mo><m:mi>η</m:mi></m:mrow></m:math> in the formulation of the Gaussian as
an exponential family distribution); and the
last equality follows from Assumption 3.</para>
      </section>
      <section id="uid33">
        <title>Logistic Regression</title>
        <para id="id157161">We now consider logistic regression. Here we are interested in binary
classification, so <m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>∈</m:mo><m:mo>{</m:mo><m:mn>0</m:mn><m:mo>,</m:mo><m:mn>1</m:mn><m:mo>}</m:mo></m:mrow></m:math>. Given that <m:math overflow="scroll"><m:mi>y</m:mi></m:math> is binary-valued, it therefore seems natural to choose
the Bernoulli family of distributions to model the conditional distribution of
<m:math overflow="scroll"><m:mi>y</m:mi></m:math> given <m:math overflow="scroll"><m:mi>x</m:mi></m:math>. In our formulation of the Bernoulli distribution as an exponential
family distribution, we had <m:math overflow="scroll"><m:mrow><m:mi>Φ</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>/</m:mo><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>+</m:mo><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>η</m:mi></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:math>. Furthermore, note
that if <m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>∼</m:mo><m:mi> Bernoulli </m:mi><m:mo>(</m:mo><m:mi>Φ</m:mi><m:mo>)</m:mo></m:mrow></m:math>, then
<m:math overflow="scroll"><m:mrow><m:mi mathvariant="normal">E</m:mi><m:mo>[</m:mo><m:mi>y</m:mi><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>]</m:mo><m:mo>=</m:mo><m:mi>Φ</m:mi></m:mrow></m:math>. So, following a similar derivation as the one for
ordinary least squares, we get:</para>
        <equation id="id157316">
          <m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:msub>
                      <m:mi>h</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>x</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mi>E</m:mi>
                    <m:mo>[</m:mo>
                    <m:mi>y</m:mi>
                    <m:mo>|</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>;</m:mo>
                    <m:mi>θ</m:mi>
                    <m:mo>]</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mi>Φ</m:mi>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mn>1</m:mn>
                    <m:mo>/</m:mo>
                    <m:mo>(</m:mo>
                    <m:mn>1</m:mn>
                    <m:mo>+</m:mo>
                    <m:msup>
                      <m:mi>e</m:mi>
                      <m:mrow>
                        <m:mo>-</m:mo>
                        <m:mi>η</m:mi>
                      </m:mrow>
                    </m:msup>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mn>1</m:mn>
                    <m:mo>/</m:mo>
                    <m:mo>(</m:mo>
                    <m:mn>1</m:mn>
                    <m:mo>+</m:mo>
                    <m:msup>
                      <m:mi>e</m:mi>
                      <m:mrow>
                        <m:mo>-</m:mo>
                        <m:msup>
                          <m:mi>θ</m:mi>
                          <m:mi>T</m:mi>
                        </m:msup>
                        <m:mi>x</m:mi>
                      </m:mrow>
                    </m:msup>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id157459">So, this gives us hypothesis functions of the form <m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>/</m:mo><m:mrow><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>+</m:mo><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:msup><m:mi>θ</m:mi><m:mi>T</m:mi></m:msup><m:mi>x</m:mi></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:mrow></m:math>.
If you are previously wondering how we came up with the form of the
logistic function <m:math overflow="scroll"><m:mrow><m:mn>1</m:mn><m:mo>/</m:mo><m:mo>(</m:mo><m:mn>1</m:mn><m:mo>+</m:mo><m:msup><m:mi>e</m:mi><m:mrow><m:mo>-</m:mo><m:mi>z</m:mi></m:mrow></m:msup><m:mo>)</m:mo></m:mrow></m:math>, this gives one answer: Once we
assume that <m:math overflow="scroll"><m:mi>y</m:mi></m:math> conditioned on <m:math overflow="scroll"><m:mi>x</m:mi></m:math> is Bernoulli, it arises as
a consequence of the definition of GLMs and exponential family distributions.</para>
        <para id="id157574">To introduce a little more terminology, the function <m:math overflow="scroll"><m:mi>g</m:mi></m:math> giving the distribution's mean as
a function of the natural parameter (<m:math overflow="scroll"><m:mrow><m:mi>g</m:mi><m:mo>(</m:mo><m:mi>η</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi mathvariant="normal">E</m:mi><m:mo>[</m:mo><m:mi>T</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo><m:mo>;</m:mo><m:mi>η</m:mi><m:mo>]</m:mo></m:mrow></m:math>) is called
the <emphasis effect="bold">canonical response function</emphasis>. Its inverse, <m:math overflow="scroll"><m:msup><m:mi>g</m:mi><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup></m:math>, is called
the <emphasis effect="bold">canonical link function</emphasis>. Thus, the canonical response function
for the Gaussian family is just the identify function; and the canonical
response function for the Bernoulli is the logistic function.<footnote id="uid34">Many
texts use <m:math overflow="scroll"><m:mi>g</m:mi></m:math> to denote the link function, and <m:math overflow="scroll"><m:msup><m:mi>g</m:mi><m:mrow><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup></m:math> to denote the response
function; but the notation we're using here, inherited from the early machine
learning literature, will be more consistent with the notation used in the
rest of the class.</footnote></para>
      </section>
      <section id="uid35">
        <title>Softmax Regression</title>
        <para id="id157703">Let's look at one more example of a GLM. Consider a classification problem in which
the response variable <m:math overflow="scroll"><m:mi>y</m:mi></m:math> can take on any one of <m:math overflow="scroll"><m:mi>k</m:mi></m:math> values,
so <m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>∈</m:mo><m:mo>{</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mn>2</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>k</m:mi><m:mo>}</m:mo></m:mrow></m:math>. For example, rather than classifying email into
the two classes spam or not-spam—which would have been a binary
classification problem—we might want to classify it into three classes,
such as spam, personal mail, and work-related mail. The response variable is
still discrete, but can now take on more than two values. We will
thus model it as distributed according to a multinomial distribution.</para>
        <para id="id157764">Let's derive a GLM for modelling this type of multinomial data. To do so, we will
begin by expressing the multinomial as an exponential family distribution.</para>
        <para id="id157769">To parameterize a multinomial over <m:math overflow="scroll"><m:mi>k</m:mi></m:math> possible outcomes, one could use <m:math overflow="scroll"><m:mi>k</m:mi></m:math> parameters
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>Φ</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>Φ</m:mi><m:mi>k</m:mi></m:msub></m:mrow></m:math> specifying the probability of each of the outcomes. However,
these parameters would be redundant, or more formally, they would not be
independent (since knowing any <m:math overflow="scroll"><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math> of the <m:math overflow="scroll"><m:msub><m:mi>Φ</m:mi><m:mi>i</m:mi></m:msub></m:math>'s uniquely determines
the last one, as they must satisfy <m:math overflow="scroll"><m:mrow><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>k</m:mi></m:msubsup><m:msub><m:mi>Φ</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math> = 1). So, we will
instead parameterize the multinomial with only <m:math overflow="scroll"><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math> parameters,
<m:math overflow="scroll"><m:mrow><m:msub><m:mi>Φ</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>Φ</m:mi><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:mrow></m:math>, where <m:math overflow="scroll"><m:mrow><m:msub><m:mi>Φ</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mi>p</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>=</m:mo><m:mi>i</m:mi><m:mo>;</m:mo><m:mi>Φ</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math>, and
<m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>=</m:mo><m:mi>k</m:mi><m:mo>;</m:mo><m:mi>Φ</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>-</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msubsup><m:msub><m:mi>Φ</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math>. For notational convenience, we
will also let <m:math overflow="scroll"><m:mrow><m:msub><m:mi>Φ</m:mi><m:mi>k</m:mi></m:msub><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>-</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msubsup><m:msub><m:mi>Φ</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math>, but we should keep in mind that this
is not a parameter, and that it is fully specified by <m:math overflow="scroll"><m:mrow><m:msub><m:mi>Φ</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>Φ</m:mi><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub></m:mrow></m:math>.</para>
        <para id="id158116">To express the multinomial as an exponential family distribution, we will define
<m:math overflow="scroll"><m:mrow><m:mi>T</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow><m:mo>∈</m:mo><m:msup><m:mrow><m:mi mathvariant="double-struck">R</m:mi></m:mrow><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msup></m:mrow></m:math> as follows:

</para>
        <equation id="id158273"><m:math overflow="scroll" mode="display">
            <m:mrow>
              <m:mi>T</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>1</m:mn>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
<m:mfenced separators="" open="[" close="]">
<m:mtable>
<m:mtr>
 <m:mtd>
   <m:mn>1</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>⋮</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
</m:mtable>
</m:mfenced>

              <m:mo>,</m:mo>
              <m:mspace width="0.277778em"/>
              <m:mi>T</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>2</m:mn>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
<m:mfenced separators="" open="[" close="]">
<m:mtable>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>1</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>⋮</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
</m:mtable>
</m:mfenced>
              <m:mo>,</m:mo>
              <m:mspace width="0.277778em"/>
              <m:mi>T</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mn>3</m:mn>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
<m:mfenced separators="" open="[" close="]">
<m:mtable>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>1</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>⋮</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
</m:mtable>
</m:mfenced>
              <m:mo>,</m:mo>
              <m:mspace width="0.277778em"/>
              <m:mo>⋯</m:mo>
              <m:mo>,</m:mo>
              <m:mi>T</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>k</m:mi>
                <m:mo>-</m:mo>
                <m:mn>1</m:mn>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
<m:mfenced separators="" open="[" close="]">
<m:mtable>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>⋮</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>1</m:mn>
</m:mtd>
</m:mtr>
</m:mtable>
</m:mfenced>
              <m:mo>,</m:mo>
              <m:mspace width="0.277778em"/>
              <m:mi>T</m:mi>
              <m:mrow>
                <m:mo>(</m:mo>
                <m:mi>k</m:mi>
                <m:mo>)</m:mo>
              </m:mrow>
              <m:mo>=</m:mo>
<m:mfenced separators="" open="[" close="]">
<m:mtable>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>⋮</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>0</m:mn>
</m:mtd>
</m:mtr>
</m:mtable>
</m:mfenced>
              <m:mo>,</m:mo>
              <m:mspace width="0.277778em"/>
            </m:mrow>
          </m:math>
        </equation><para id="id158412">
Unlike our previous examples, here we do <emphasis effect="italics">not</emphasis> have <m:math overflow="scroll"><m:mrow><m:mi>T</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo><m:mo>=</m:mo><m:mi>y</m:mi></m:mrow></m:math>; also,
<m:math overflow="scroll"><m:mrow><m:mi>T</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:math> is now a <m:math overflow="scroll"><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math> dimensional vector, rather than a real number.
We will write <m:math overflow="scroll"><m:msub><m:mrow><m:mo>(</m:mo><m:mi>T</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow><m:mi>i</m:mi></m:msub></m:math> to denote the <m:math overflow="scroll"><m:mi>i</m:mi></m:math>-th element of the vector <m:math overflow="scroll"><m:mrow><m:mi>T</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:math>.</para>
        <para id="id158531">We introduce one more very useful piece of notation. An indicator function <m:math overflow="scroll"><m:mrow><m:mn>1</m:mn><m:mo>{</m:mo><m:mo>·</m:mo><m:mo>}</m:mo></m:mrow></m:math>
takes on a value of 1 if its argument is true, and 0 otherwise
(<m:math overflow="scroll"><m:mrow><m:mn>1</m:mn><m:mo>{</m:mo><m:mi> True </m:mi><m:mo>}</m:mo><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>, <m:math overflow="scroll"><m:mrow><m:mn>1</m:mn><m:mo>{</m:mo><m:mi> False </m:mi><m:mo>}</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>). For example, <m:math overflow="scroll"><m:mrow><m:mn>1</m:mn><m:mo>{</m:mo><m:mn>2</m:mn><m:mo>=</m:mo><m:mn>3</m:mn><m:mo>}</m:mo><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>,
and <m:math overflow="scroll"><m:mrow><m:mn>1</m:mn><m:mo>{</m:mo><m:mn>3</m:mn><m:mo>=</m:mo><m:mn>5</m:mn><m:mo>-</m:mo><m:mn>2</m:mn><m:mo>}</m:mo><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow></m:math>. So, we can also write the relationship between
<m:math overflow="scroll"><m:mrow><m:mi>T</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow></m:math> and <m:math overflow="scroll"><m:mi>y</m:mi></m:math> as <m:math overflow="scroll"><m:mrow><m:msub><m:mrow><m:mo>(</m:mo><m:mi>T</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:mn>1</m:mn><m:mrow><m:mo>{</m:mo><m:mi>y</m:mi><m:mo>=</m:mo><m:mi>i</m:mi><m:mo>}</m:mo></m:mrow></m:mrow></m:math>. (Before you continue reading,
please make sure you understand why this is true!) Further, we
have that <m:math overflow="scroll"><m:mrow><m:mi mathvariant="normal">E</m:mi><m:mrow><m:mo>[</m:mo><m:msub><m:mrow><m:mo>(</m:mo><m:mi>T</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>)</m:mo></m:mrow><m:mo>)</m:mo></m:mrow><m:mi>i</m:mi></m:msub><m:mo>]</m:mo></m:mrow><m:mo>=</m:mo><m:mi>P</m:mi><m:mrow><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>=</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:msub><m:mi>Φ</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math>.</para>
        <para id="id158784">We are now ready to show that the multinomial is a member of the
exponential family. We have:</para>
        <equation id="id158788">
          <m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:mi>p</m:mi>
                    <m:mo>(</m:mo>
                    <m:mi>y</m:mi>
                    <m:mo>;</m:mo>
                    <m:mi>Φ</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:msubsup>
                      <m:mi>Φ</m:mi>
                      <m:mn>1</m:mn>
                      <m:mrow>
                        <m:mn>1</m:mn>
                        <m:mo>{</m:mo>
                        <m:mi>y</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>1</m:mn>
                        <m:mo>}</m:mo>
                      </m:mrow>
                    </m:msubsup>
                    <m:msubsup>
                      <m:mi>Φ</m:mi>
                      <m:mn>2</m:mn>
                      <m:mrow>
                        <m:mn>1</m:mn>
                        <m:mo>{</m:mo>
                        <m:mi>y</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>2</m:mn>
                        <m:mo>}</m:mo>
                      </m:mrow>
                    </m:msubsup>
                    <m:mo>⋯</m:mo>
                    <m:msubsup>
                      <m:mi>Φ</m:mi>
                      <m:mi>k</m:mi>
                      <m:mrow>
                        <m:mn>1</m:mn>
                        <m:mo>{</m:mo>
                        <m:mi>y</m:mi>
                        <m:mo>=</m:mo>
                        <m:mi>k</m:mi>
                        <m:mo>}</m:mo>
                      </m:mrow>
                    </m:msubsup>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:msubsup>
                      <m:mi>Φ</m:mi>
                      <m:mn>1</m:mn>
                      <m:mrow>
                        <m:mn>1</m:mn>
                        <m:mo>{</m:mo>
                        <m:mi>y</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>1</m:mn>
                        <m:mo>}</m:mo>
                      </m:mrow>
                    </m:msubsup>
                    <m:msubsup>
                      <m:mi>Φ</m:mi>
                      <m:mn>2</m:mn>
                      <m:mrow>
                        <m:mn>1</m:mn>
                        <m:mo>{</m:mo>
                        <m:mi>y</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>2</m:mn>
                        <m:mo>}</m:mo>
                      </m:mrow>
                    </m:msubsup>
                    <m:mo>⋯</m:mo>
                    <m:msubsup>
                      <m:mi>Φ</m:mi>
                      <m:mi>k</m:mi>
                      <m:mrow>
                        <m:mn>1</m:mn>
                        <m:mo>-</m:mo>
                        <m:msubsup>
                          <m:mo>∑</m:mo>
                          <m:mrow>
                            <m:mi>i</m:mi>
                            <m:mo>=</m:mo>
                            <m:mn>1</m:mn>
                          </m:mrow>
                          <m:mrow>
                            <m:mi>k</m:mi>
                            <m:mo>-</m:mo>
                            <m:mn>1</m:mn>
                          </m:mrow>
                        </m:msubsup>
                        <m:mn>1</m:mn>
                        <m:mrow>
                          <m:mo>{</m:mo>
                          <m:mi>y</m:mi>
                          <m:mo>=</m:mo>
                          <m:mi>i</m:mi>
                          <m:mo>}</m:mo>
                        </m:mrow>
                      </m:mrow>
                    </m:msubsup>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:msubsup>
                      <m:mi>Φ</m:mi>
                      <m:mn>1</m:mn>
                      <m:msub>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>T</m:mi>
                          <m:mrow>
                            <m:mo>(</m:mo>
                            <m:mi>y</m:mi>
                            <m:mo>)</m:mo>
                          </m:mrow>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mn>1</m:mn>
                      </m:msub>
                    </m:msubsup>
                    <m:msubsup>
                      <m:mi>Φ</m:mi>
                      <m:mn>2</m:mn>
                      <m:msub>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>T</m:mi>
                          <m:mrow>
                            <m:mo>(</m:mo>
                            <m:mi>y</m:mi>
                            <m:mo>)</m:mo>
                          </m:mrow>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mn>2</m:mn>
                      </m:msub>
                    </m:msubsup>
                    <m:mo>⋯</m:mo>
                    <m:msubsup>
                      <m:mi>Φ</m:mi>
                      <m:mi>k</m:mi>
                      <m:mrow>
                        <m:mn>1</m:mn>
                        <m:mo>-</m:mo>
                        <m:msubsup>
                          <m:mo>∑</m:mo>
                          <m:mrow>
                            <m:mi>i</m:mi>
                            <m:mo>=</m:mo>
                            <m:mn>1</m:mn>
                          </m:mrow>
                          <m:mrow>
                            <m:mi>k</m:mi>
                            <m:mo>-</m:mo>
                            <m:mn>1</m:mn>
                          </m:mrow>
                        </m:msubsup>
                        <m:msub>
                          <m:mrow>
                            <m:mo>(</m:mo>
                            <m:mi>T</m:mi>
                            <m:mrow>
                              <m:mo>(</m:mo>
                              <m:mi>y</m:mi>
                              <m:mo>)</m:mo>
                            </m:mrow>
                            <m:mo>)</m:mo>
                          </m:mrow>
                          <m:mi>i</m:mi>
                        </m:msub>
                      </m:mrow>
                    </m:msubsup>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mo form="prefix">exp</m:mo>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>T</m:mi>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>y</m:mi>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo form="prefix">log</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mn>1</m:mn>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>+</m:mo>
                    <m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>T</m:mi>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>y</m:mi>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mn>2</m:mn>
                    </m:msub>
                    <m:mo form="prefix">log</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mn>2</m:mn>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>+</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd/>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mo>⋯</m:mo>
                    <m:mo>+</m:mo>
                    <m:mfenced separators="" open="(" close=")">
                      <m:mrow>
                        <m:mn>1</m:mn>
                        <m:mo>-</m:mo>
                        <m:mstyle scriptlevel="0" displaystyle="false">
                          <m:mrow>
                            <m:msubsup>
                              <m:mo>∑</m:mo>
                              <m:mrow>
                                <m:mi>i</m:mi>
                                <m:mo>=</m:mo>
                                <m:mn>1</m:mn>
                              </m:mrow>
                              <m:mrow>
                                <m:mi>k</m:mi>
                                <m:mo>-</m:mo>
                                <m:mn>1</m:mn>
                              </m:mrow>
                            </m:msubsup>
                            <m:msub>
                              <m:mrow>
                                <m:mo>(</m:mo>
                                <m:mi>T</m:mi>
                                <m:mrow>
                                  <m:mo>(</m:mo>
                                  <m:mi>y</m:mi>
                                  <m:mo>)</m:mo>
                                </m:mrow>
                                <m:mo>)</m:mo>
                              </m:mrow>
                              <m:mi>i</m:mi>
                            </m:msub>
                          </m:mrow>
                        </m:mstyle>
                      </m:mrow>
                    </m:mfenced>
                    <m:mo form="prefix">log</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mi>k</m:mi>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mrow>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mo form="prefix">exp</m:mo>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>T</m:mi>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>y</m:mi>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mn>1</m:mn>
                    </m:msub>
                    <m:mo form="prefix">log</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mn>1</m:mn>
                      </m:msub>
                      <m:mo>/</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mi>k</m:mi>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>+</m:mo>
                    <m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>T</m:mi>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>y</m:mi>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mn>2</m:mn>
                    </m:msub>
                    <m:mo form="prefix">log</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mn>2</m:mn>
                      </m:msub>
                      <m:mo>/</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mi>k</m:mi>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>+</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd/>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mspace width="0.277778em"/>
                    <m:mo>⋯</m:mo>
                    <m:mo>+</m:mo>
                    <m:msub>
                      <m:mrow>
                        <m:mo>(</m:mo>
                        <m:mi>T</m:mi>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>y</m:mi>
                          <m:mo>)</m:mo>
                        </m:mrow>
                        <m:mo>)</m:mo>
                      </m:mrow>
                      <m:mrow>
                        <m:mi>k</m:mi>
                        <m:mo>-</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                    </m:msub>
                    <m:mo form="prefix">log</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mrow>
                          <m:mi>k</m:mi>
                          <m:mo>-</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                      </m:msub>
                      <m:mo>/</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mi>k</m:mi>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>+</m:mo>
                    <m:mo form="prefix">log</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mi>k</m:mi>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mrow>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mi>b</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>y</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo form="prefix">exp</m:mo>
                    <m:mo>(</m:mo>
                    <m:msup>
                      <m:mi>η</m:mi>
                      <m:mi>T</m:mi>
                    </m:msup>
                    <m:mi>T</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>y</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>-</m:mo>
                    <m:mi>a</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>η</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id159648">where
</para>
        <equation id="id159740"><m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mi>η</m:mi>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>

<m:mfenced separators="" open="[" close="]">
<m:mtable>

<m:mtr>
 <m:mtd>
                       <m:mo form="prefix">log</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mrow>
                          <m:mn>1</m:mn>
                        </m:mrow>
                      </m:msub>
                      <m:mo>/</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mi>k</m:mi>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
                       <m:mo form="prefix">log</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mrow>
                          <m:mn>2</m:mn>
                        </m:mrow>
                      </m:msub>
                      <m:mo>/</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mi>k</m:mi>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>⋮</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
                       <m:mo form="prefix">log</m:mo>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mrow>
                          <m:mi>k</m:mi>
                          <m:mo>-</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                      </m:msub>
                      <m:mo>/</m:mo>
                      <m:msub>
                        <m:mi>Φ</m:mi>
                        <m:mi>k</m:mi>
                      </m:msub>
                      <m:mo>)</m:mo>
                    </m:mrow>
</m:mtd>
</m:mtr>
</m:mtable>
</m:mfenced>

                    <m:mo>,</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:mi>a</m:mi>
                    <m:mo>(</m:mo>
                    <m:mi>η</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mo>-</m:mo>
                    <m:mo form="prefix">log</m:mo>
                    <m:mo>(</m:mo>
                    <m:msub>
                      <m:mi>Φ</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:mi>b</m:mi>
                    <m:mo>(</m:mo>
                    <m:mi>y</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mn>1</m:mn>
                    <m:mo>.</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation><para id="id159842">This completes our formulation of the multinomial as an exponential family
distribution.</para>
        <para id="id159849">The link function is given (for <m:math overflow="scroll"><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>k</m:mi></m:mrow></m:math>) by</para>
        <equation id="id159876">
          <m:math overflow="scroll" mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>η</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mo form="prefix">log</m:mo>
              <m:mfrac>
                <m:msub>
                  <m:mi>Φ</m:mi>
                  <m:mi>i</m:mi>
                </m:msub>
                <m:msub>
                  <m:mi>Φ</m:mi>
                  <m:mi>k</m:mi>
                </m:msub>
              </m:mfrac>
              <m:mo>.</m:mo>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id159919">For convenience, we have also defined <m:math overflow="scroll"><m:mrow><m:msub><m:mi>η</m:mi><m:mi>k</m:mi></m:msub><m:mo>=</m:mo><m:mo form="prefix">log</m:mo><m:mrow><m:mo>(</m:mo><m:msub><m:mi>Φ</m:mi><m:mi>k</m:mi></m:msub><m:mo>/</m:mo><m:msub><m:mi>Φ</m:mi><m:mi>k</m:mi></m:msub><m:mo>)</m:mo></m:mrow><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>.
To invert the link function and derive the response function, we therefore have
that</para>
        <equation id="uid36">
          <m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:msup>
                    <m:mi>e</m:mi>
                    <m:msub>
                      <m:mi>η</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                  </m:msup>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mfrac>
                    <m:msub>
                      <m:mi>Φ</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:msub>
                      <m:mi>Φ</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                  </m:mfrac>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:msub>
                      <m:mi>Φ</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:msup>
                      <m:mi>e</m:mi>
                      <m:msub>
                        <m:mi>η</m:mi>
                        <m:mi>i</m:mi>
                      </m:msub>
                    </m:msup>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:msub>
                    <m:mi>Φ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:msub>
                      <m:mi>Φ</m:mi>
                      <m:mi>k</m:mi>
                    </m:msub>
                    <m:munderover>
                      <m:mo>∑</m:mo>
                      <m:mrow>
                        <m:mi>i</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                      <m:mi>k</m:mi>
                    </m:munderover>
                    <m:msup>
                      <m:mi>e</m:mi>
                      <m:msub>
                        <m:mi>η</m:mi>
                        <m:mi>i</m:mi>
                      </m:msub>
                    </m:msup>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:munderover>
                      <m:mo>∑</m:mo>
                      <m:mrow>
                        <m:mi>i</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                      <m:mi>k</m:mi>
                    </m:munderover>
                    <m:msub>
                      <m:mi>Φ</m:mi>
                      <m:mi>i</m:mi>
                    </m:msub>
                    <m:mo>=</m:mo>
                    <m:mn>1</m:mn>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id160151">This implies that <m:math overflow="scroll"><m:mrow><m:msub><m:mi>Φ</m:mi><m:mi>k</m:mi></m:msub><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>/</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mi>k</m:mi></m:msubsup><m:msup><m:mi>e</m:mi><m:msub><m:mi>η</m:mi><m:mi>i</m:mi></m:msub></m:msup></m:mrow></m:math>, which can be substituted back
into Equation <link target-id="uid36"/> to give the response function</para>
        <equation id="id160214">
          <m:math overflow="scroll" mode="display">
            <m:mrow>
              <m:msub>
                <m:mi>Φ</m:mi>
                <m:mi>i</m:mi>
              </m:msub>
              <m:mo>=</m:mo>
              <m:mfrac>
                <m:msup>
                  <m:mi>e</m:mi>
                  <m:msub>
                    <m:mi>η</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:msup>
                <m:mrow>
                  <m:msubsup>
                    <m:mo>∑</m:mo>
                    <m:mrow>
                      <m:mi>j</m:mi>
                      <m:mo>=</m:mo>
                      <m:mn>1</m:mn>
                    </m:mrow>
                    <m:mi>k</m:mi>
                  </m:msubsup>
                  <m:msup>
                    <m:mi>e</m:mi>
                    <m:msub>
                      <m:mi>η</m:mi>
                      <m:mi>j</m:mi>
                    </m:msub>
                  </m:msup>
                </m:mrow>
              </m:mfrac>
            </m:mrow>
          </m:math>
        </equation>
        <para id="id160279">This function mapping from the <m:math overflow="scroll"><m:mi>η</m:mi></m:math>'s to the <m:math overflow="scroll"><m:mi>Φ</m:mi></m:math>'s is called the
<emphasis effect="bold">softmax</emphasis> function.</para>
        <para id="id160309">To complete our model, we use Assumption 3, given earlier, that
the <m:math overflow="scroll"><m:msub><m:mi>η</m:mi><m:mi>i</m:mi></m:msub></m:math>'s are linearly related to the <m:math overflow="scroll"><m:mi>x</m:mi></m:math>'s. So,
have <m:math overflow="scroll"><m:mrow><m:msub><m:mi>η</m:mi><m:mi>i</m:mi></m:msub><m:mo>=</m:mo><m:msubsup><m:mi>θ</m:mi><m:mi>i</m:mi><m:mi>T</m:mi></m:msubsup><m:mi>x</m:mi></m:mrow></m:math> (for <m:math overflow="scroll"><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math>),
where <m:math overflow="scroll"><m:mrow><m:msub><m:mi>θ</m:mi><m:mn>1</m:mn></m:msub><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:msub><m:mi>θ</m:mi><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msub><m:mo>∈</m:mo><m:msup><m:mrow><m:mi mathvariant="double-struck">R</m:mi></m:mrow><m:mrow><m:mi>n</m:mi><m:mo>+</m:mo><m:mn>1</m:mn></m:mrow></m:msup></m:mrow></m:math> are the parameters of
our model. For notational convenience, we can also define <m:math overflow="scroll"><m:mrow><m:msub><m:mi>θ</m:mi><m:mi>k</m:mi></m:msub><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>, so
that <m:math overflow="scroll"><m:mrow><m:msub><m:mi>η</m:mi><m:mi>k</m:mi></m:msub><m:mo>=</m:mo><m:msubsup><m:mi>θ</m:mi><m:mi>k</m:mi><m:mi>T</m:mi></m:msubsup><m:mi>x</m:mi><m:mo>=</m:mo><m:mn>0</m:mn></m:mrow></m:math>, as given previously. Hence, our model assumes
that the conditional distribution of <m:math overflow="scroll"><m:mi>y</m:mi></m:math> given <m:math overflow="scroll"><m:mi>x</m:mi></m:math> is given by</para>
        <equation id="uid37">
          <m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:mi>p</m:mi>
                    <m:mo>(</m:mo>
                    <m:mi>y</m:mi>
                    <m:mo>=</m:mo>
                    <m:mi>i</m:mi>
                    <m:mo>|</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>;</m:mo>
                    <m:mi>θ</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:msub>
                    <m:mi>Φ</m:mi>
                    <m:mi>i</m:mi>
                  </m:msub>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mfrac>
                    <m:msup>
                      <m:mi>e</m:mi>
                      <m:msub>
                        <m:mi>η</m:mi>
                        <m:mi>i</m:mi>
                      </m:msub>
                    </m:msup>
                    <m:mrow>
                      <m:msubsup>
                        <m:mo>∑</m:mo>
                        <m:mrow>
                          <m:mi>j</m:mi>
                          <m:mo>=</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                        <m:mi>k</m:mi>
                      </m:msubsup>
                      <m:msup>
                        <m:mi>e</m:mi>
                        <m:msub>
                          <m:mi>η</m:mi>
                          <m:mi>j</m:mi>
                        </m:msub>
                      </m:msup>
                    </m:mrow>
                  </m:mfrac>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mfrac>
                    <m:msup>
                      <m:mi>e</m:mi>
                      <m:mrow>
                        <m:msubsup>
                          <m:mi>θ</m:mi>
                          <m:mi>i</m:mi>
                          <m:mi>T</m:mi>
                        </m:msubsup>
                        <m:mi>x</m:mi>
                      </m:mrow>
                    </m:msup>
                    <m:mrow>
                      <m:msubsup>
                        <m:mo>∑</m:mo>
                        <m:mrow>
                          <m:mi>j</m:mi>
                          <m:mo>=</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                        <m:mi>k</m:mi>
                      </m:msubsup>
                      <m:msup>
                        <m:mi>e</m:mi>
                        <m:mrow>
                          <m:msubsup>
                            <m:mi>θ</m:mi>
                            <m:mi>j</m:mi>
                            <m:mi>T</m:mi>
                          </m:msubsup>
                          <m:mi>x</m:mi>
                        </m:mrow>
                      </m:msup>
                    </m:mrow>
                  </m:mfrac>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id160699">This model, which applies to classification problems
where <m:math overflow="scroll"><m:mrow><m:mi>y</m:mi><m:mo>∈</m:mo><m:mo>{</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>k</m:mi><m:mo>}</m:mo></m:mrow></m:math>, is called <emphasis effect="bold">softmax regression</emphasis>.
It is a generalization of logistic regression.</para>
        <para id="id160739">Our hypothesis will output
</para>
        <equation id="id160955"><m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:msub>
                      <m:mi>h</m:mi>
                      <m:mi>θ</m:mi>
                    </m:msub>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:mi>x</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mi mathvariant="normal">E</m:mi>
                    <m:mo>[</m:mo>
                    <m:mi>T</m:mi>
                    <m:mo>(</m:mo>
                    <m:mi>y</m:mi>
                    <m:mo>)</m:mo>
                    <m:mo>|</m:mo>
                    <m:mi>x</m:mi>
                    <m:mo>;</m:mo>
                    <m:mi>θ</m:mi>
                    <m:mo>]</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:mi mathvariant="normal">E</m:mi>
                    <m:mfenced separators="" open="[" close="]">
                     <m:mfenced separators="" open="" close="|"> 
<m:mtable>

<m:mtr>
 <m:mtd>

<m:mn>1</m:mn>
<m:mfenced separators="" open="{" close="}">
<m:mi>y</m:mi>
<m:mo>=</m:mo>
<m:mn>1</m:mn>
</m:mfenced>

</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>

<m:mn>1</m:mn>
<m:mfenced separators="" open="{" close="}">
<m:mi>y</m:mi>
<m:mo>=</m:mo>
<m:mn>2</m:mn>
</m:mfenced>

</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>⋮</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>

<m:mn>1</m:mn>
<m:mfenced separators="" open="{" close="}">
<m:mi>y</m:mi>
<m:mo>=</m:mo>
<m:mi>k</m:mi>
<m:mo>-</m:mo>
<m:mn>1</m:mn>
</m:mfenced>

</m:mtd>
</m:mtr>
</m:mtable>


</m:mfenced>

                      <m:mspace width="0.166667em"/>
                      <m:mi>x</m:mi>
                      <m:mo>;</m:mo>
                      <m:mi>θ</m:mi>
                    </m:mfenced>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">

<m:mfenced separators="" open="[" close="]">
<m:mtable>

<m:mtr>
 <m:mtd>
<m:msub>
<m:mn>Φ</m:mn>
<m:mn>1</m:mn>
</m:msub>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
<m:msub>
<m:mn>Φ</m:mn>
<m:mn>2</m:mn>
</m:msub>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>⋮</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
<m:msub>
<m:mn>Φ</m:mn>
<m:mrow>
<m:mi>k</m:mi>
<m:mn>-</m:mn>
<m:mn>1</m:mn>
</m:mrow>
</m:msub>
</m:mtd>
</m:mtr>
</m:mtable>
</m:mfenced>

                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    
<m:mfenced separators="" open="[" close="]">
<m:mtable>

<m:mtr>
 <m:mtd>

                  <m:mfrac>
                        <m:mrow>
                        <m:mo form="prefix">exp</m:mo>
                          <m:msubsup>
                            <m:mi>θ</m:mi>
                            <m:mrow>
                              <m:mn>1</m:mn>
                            </m:mrow>
                            <m:mi>T</m:mi>
                          </m:msubsup>
                          <m:mi>x</m:mi>
                        </m:mrow>
                    <m:mrow>

                      <m:msubsup>
                        <m:mo>∑</m:mo>
                        <m:mrow>
                          <m:mi>j</m:mi>
                          <m:mo>=</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                        <m:mi>k</m:mi>
                      </m:msubsup>
                      
                      <m:mo form="prefix">exp</m:mo>
                        <m:mrow>
                          <m:msubsup>
                            <m:mi>θ</m:mi>
                            <m:mi>j</m:mi>
                            <m:mi>T</m:mi>
                          </m:msubsup>
                          <m:mi>x</m:mi>
                        </m:mrow>
                      
                    </m:mrow>
                  </m:mfrac>

</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>

                  <m:mfrac>
                        <m:mrow>
                        <m:mo form="prefix">exp</m:mo>
                          <m:msubsup>
                            <m:mi>θ</m:mi>
                            <m:mrow>
                              <m:mn>2</m:mn>
                            </m:mrow>
                            <m:mi>T</m:mi>
                          </m:msubsup>
                          <m:mi>x</m:mi>
                        </m:mrow>
                    <m:mrow>

                      <m:msubsup>
                        <m:mo>∑</m:mo>
                        <m:mrow>
                          <m:mi>j</m:mi>
                          <m:mo>=</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                        <m:mi>k</m:mi>
                      </m:msubsup>
                      
                      <m:mo form="prefix">exp</m:mo>
                        <m:mrow>
                          <m:msubsup>
                            <m:mi>θ</m:mi>
                            <m:mi>j</m:mi>
                            <m:mi>T</m:mi>
                          </m:msubsup>
                          <m:mi>x</m:mi>
                        </m:mrow>
                      
                    </m:mrow>
                  </m:mfrac>

</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>
   <m:mn>⋮</m:mn>
</m:mtd>
</m:mtr>
<m:mtr>
 <m:mtd>

                  <m:mfrac>
                        <m:mrow>
                        <m:mo form="prefix">exp</m:mo>
                          <m:msubsup>
                            <m:mi>θ</m:mi>
                            <m:mrow>
                              <m:mi>k</m:mi>
                              <m:mi>-</m:mi>
                              <m:mn>1</m:mn>
                            </m:mrow>
                            <m:mi>T</m:mi>
                          </m:msubsup>
                          <m:mi>x</m:mi>
                        </m:mrow>
                    <m:mrow>

                      <m:msubsup>
                        <m:mo>∑</m:mo>
                        <m:mrow>
                          <m:mi>j</m:mi>
                          <m:mo>=</m:mo>
                          <m:mn>1</m:mn>
                        </m:mrow>
                        <m:mi>k</m:mi>
                      </m:msubsup>
                      
                      <m:mo form="prefix">exp</m:mo>
                        <m:mrow>
                          <m:msubsup>
                            <m:mi>θ</m:mi>
                            <m:mi>j</m:mi>
                            <m:mi>T</m:mi>
                          </m:msubsup>
                          <m:mi>x</m:mi>
                        </m:mrow>
                      
                    </m:mrow>
                  </m:mfrac>

</m:mtd>
</m:mtr>
</m:mtable>
</m:mfenced>

                    <m:mo>.</m:mo>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation><para id="id161095">In other words, our hypothesis will output the estimated probability that <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>=</m:mo><m:mi>i</m:mi><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>, for every
value of <m:math overflow="scroll"><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>k</m:mi></m:mrow></m:math>. (Even though <m:math overflow="scroll"><m:mrow><m:msub><m:mi>h</m:mi><m:mi>θ</m:mi></m:msub><m:mrow><m:mo>(</m:mo><m:mi>x</m:mi><m:mo>)</m:mo></m:mrow></m:mrow></m:math> as defined above is only <m:math overflow="scroll"><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:math> dimensional,
clearly <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>=</m:mo><m:mi>k</m:mi><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math> can be obtained as <m:math overflow="scroll"><m:mrow><m:mn>1</m:mn><m:mo>-</m:mo><m:msubsup><m:mo>∑</m:mo><m:mrow><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn></m:mrow><m:mrow><m:mi>k</m:mi><m:mo>-</m:mo><m:mn>1</m:mn></m:mrow></m:msubsup><m:msub><m:mi>Φ</m:mi><m:mi>i</m:mi></m:msub></m:mrow></m:math>.)</para>
        <para id="id161261">Lastly, let's discuss parameter fitting. Similar to our original derivation of ordinary least squares
and logistic regression, if we have a training set of <m:math overflow="scroll"><m:mi>m</m:mi></m:math> examples <m:math overflow="scroll"><m:mrow><m:mo>{</m:mo><m:mrow><m:mo>(</m:mo><m:msup><m:mi>x</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>,</m:mo><m:msup><m:mi>y</m:mi><m:mrow><m:mo>(</m:mo><m:mi>i</m:mi><m:mo>)</m:mo></m:mrow></m:msup><m:mo>)</m:mo></m:mrow><m:mo>;</m:mo><m:mi>i</m:mi><m:mo>=</m:mo><m:mn>1</m:mn><m:mo>,</m:mo><m:mo>...</m:mo><m:mo>,</m:mo><m:mi>m</m:mi><m:mo>}</m:mo></m:mrow></m:math>
and would like to learn the parameters <m:math overflow="scroll"><m:msub><m:mi>θ</m:mi><m:mi>i</m:mi></m:msub></m:math> of this model, we would begin by writing
down the log-likelihood</para>
        <equation id="id161353">
          <m:math overflow="scroll" mode="display">
            <m:mtable displaystyle="true">
              <m:mtr>
                <m:mtd columnalign="right">
                  <m:mrow>
                    <m:mi>ℓ</m:mi>
                    <m:mo>(</m:mo>
                    <m:mi>θ</m:mi>
                    <m:mo>)</m:mo>
                  </m:mrow>
                </m:mtd>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:munderover>
                      <m:mo>∑</m:mo>
                      <m:mrow>
                        <m:mi>i</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                      <m:mi>m</m:mi>
                    </m:munderover>
                    <m:mo form="prefix">log</m:mo>
                    <m:mi>p</m:mi>
                    <m:mrow>
                      <m:mo>(</m:mo>
                      <m:msup>
                        <m:mi>y</m:mi>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>i</m:mi>
                          <m:mo>)</m:mo>
                        </m:mrow>
                      </m:msup>
                      <m:mo>|</m:mo>
                      <m:msup>
                        <m:mi>x</m:mi>
                        <m:mrow>
                          <m:mo>(</m:mo>
                          <m:mi>i</m:mi>
                          <m:mo>)</m:mo>
                        </m:mrow>
                      </m:msup>
                      <m:mo>;</m:mo>
                      <m:mi>θ</m:mi>
                      <m:mo>)</m:mo>
                    </m:mrow>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
              <m:mtr>
                <m:mtd/>
                <m:mtd>
                  <m:mo>=</m:mo>
                </m:mtd>
                <m:mtd columnalign="left">
                  <m:mrow>
                    <m:munderover>
                      <m:mo>∑</m:mo>
                      <m:mrow>
                        <m:mi>i</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                      <m:mi>m</m:mi>
                    </m:munderover>
                    <m:mo form="prefix">log</m:mo>
                    <m:munderover>
                      <m:mo>∏</m:mo>
                      <m:mrow>
                        <m:mi>l</m:mi>
                        <m:mo>=</m:mo>
                        <m:mn>1</m:mn>
                      </m:mrow>
                      <m:mi>k</m:mi>
                    </m:munderover>
                    <m:msup>
                      <m:mfenced separators="" open="(" close=")">
                        <m:mfrac>
                          <m:msup>
                            <m:mi>e</m:mi>
                            <m:mrow>
                              <m:msubsup>
                                <m:mi>θ</m:mi>
                                <m:mi>l</m:mi>
                                <m:mi>T</m:mi>
                              </m:msubsup>
                              <m:msup>
                                <m:mi>x</m:mi>
                                <m:mrow>
                                  <m:mo>(</m:mo>
                                  <m:mi>i</m:mi>
                                  <m:mo>)</m:mo>
                                </m:mrow>
                              </m:msup>
                            </m:mrow>
                          </m:msup>
                          <m:mrow>
                            <m:msubsup>
                              <m:mo>∑</m:mo>
                              <m:mrow>
                                <m:mi>j</m:mi>
                                <m:mo>=</m:mo>
                                <m:mn>1</m:mn>
                              </m:mrow>
                              <m:mi>k</m:mi>
                            </m:msubsup>
                            <m:msup>
                              <m:mi>e</m:mi>
                              <m:mrow>
                                <m:msubsup>
                                  <m:mi>θ</m:mi>
                                  <m:mi>j</m:mi>
                                  <m:mi>T</m:mi>
                                </m:msubsup>
                                <m:msup>
                                  <m:mi>x</m:mi>
                                  <m:mrow>
                                    <m:mo>(</m:mo>
                                    <m:mi>i</m:mi>
                                    <m:mo>)</m:mo>
                                  </m:mrow>
                                </m:msup>
                              </m:mrow>
                            </m:msup>
                          </m:mrow>
                        </m:mfrac>
                      </m:mfenced>
                      <m:mrow>
                        <m:mn>1</m:mn>
                        <m:mo>{</m:mo>
                        <m:msup>
                          <m:mi>y</m:mi>
                          <m:mrow>
                            <m:mo>(</m:mo>
                            <m:mi>i</m:mi>
                            <m:mo>)</m:mo>
                          </m:mrow>
                        </m:msup>
                        <m:mo>=</m:mo>
                        <m:mi>l</m:mi>
                        <m:mo>}</m:mo>
                      </m:mrow>
                    </m:msup>
                  </m:mrow>
                </m:mtd>
              </m:mtr>
            </m:mtable>
          </m:math>
        </equation>
        <para id="id161608">To obtain the second line above, we used the definition for <m:math overflow="scroll"><m:mrow><m:mi>p</m:mi><m:mo>(</m:mo><m:mi>y</m:mi><m:mo>|</m:mo><m:mi>x</m:mi><m:mo>;</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math> given in Equation <link target-id="uid37"/>.
We can now obtain the maximum likelihood estimate of the parameters by maximizing <m:math overflow="scroll"><m:mrow><m:mi>ℓ</m:mi><m:mo>(</m:mo><m:mi>θ</m:mi><m:mo>)</m:mo></m:mrow></m:math>
in terms of <m:math overflow="scroll"><m:mi>θ</m:mi></m:math>, using a method such as gradient ascent or Newton's method.</para>
      </section>
    </section>
  </content>
</document>